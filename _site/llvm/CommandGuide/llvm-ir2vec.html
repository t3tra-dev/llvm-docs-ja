
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>llvm-ir2vec - IR2Vec Embedding Generation Tool &#8212; LLVM  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../_static/llvm-theme.css?v=96924833" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="llvm-lib - LLVM lib.exe compatible library tool" href="llvm-lib.html" />
    <link rel="prev" title="llvm-dwarfutil - A tool to copy and manipulate debug info" href="llvm-dwarfutil.html" />
<style type="text/css">
  table.right { float: right; margin-left: 20px; }
  table.right td { border: 1px solid #ccc; }
</style>

  </head><body>
<div class="logo">
  <a href="../index.html">
    <img src="../_static/logo.png"
         alt="LLVM Logo" width="250" height="88"/></a>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="llvm-lib.html" title="llvm-lib - LLVM lib.exe compatible library tool"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="llvm-dwarfutil.html" title="llvm-dwarfutil - A tool to copy and manipulate debug info"
             accesskey="P">previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="../index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="../Reference.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">LLVM Command Guide</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">llvm-ir2vec - IR2Vec Embedding Generation Tool</a></li> 
      </ul>
    </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<h3>Documentation</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/GettingStartedTutorials.html">Getting Started/Tutorials</a></li>
    <li><a href="https://llvm.org/docs/UserGuides.html">User Guides</a></li>
    <li><a href="https://llvm.org/docs/Reference.html">Reference</a></li>
</ul>

<h3>Getting Involved</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/Contributing.html">Contributing to LLVM</a></li>
    <li><a href="https://llvm.org/docs/HowToSubmitABug.html">Submitting Bug Reports</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#mailing-lists">Mailing Lists</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#discord">Discord</a></li>
    <li><a href="https://llvm.org/docs/GettingInvolved.html#meetups-and-social-events">Meetups and Social Events</a></li>
</ul>

<h3>Additional Links</h3>

<ul class="want-points">
    <li><a href="https://llvm.org/docs/FAQ.html">FAQ</a></li>
    <li><a href="https://llvm.org/docs/Lexicon.html">Glossary</a></li>
    <li><a href="https://llvm.org/pubs">Publications</a></li>
    <li><a href="https://github.com/llvm/llvm-project/">Github Repository</a></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/CommandGuide/llvm-ir2vec.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="llvm-ir2vec-ir2vec-embedding-generation-tool">
<h1>llvm-ir2vec - IR2Vec Embedding Generation Tool<a class="headerlink" href="#llvm-ir2vec-ir2vec-embedding-generation-tool" title="Link to this heading">¶</a></h1>
<section id="synopsis">
<h2>SYNOPSIS<a class="headerlink" href="#synopsis" title="Link to this heading">¶</a></h2>
<p><strong class="program">llvm-ir2vec</strong> [<em>subcommand</em>] [<em>options</em>]</p>
</section>
<section id="description">
<h2>DESCRIPTION<a class="headerlink" href="#description" title="Link to this heading">¶</a></h2>
<p><strong class="program">llvm-ir2vec</strong> is a standalone command-line tool for IR2Vec. It
generates IR2Vec embeddings for LLVM IR and supports triplet generation
for vocabulary training. The tool provides three main subcommands:</p>
<ol class="arabic simple">
<li><p><strong>triplets</strong>: Generates numeric triplets in train2id format for vocabulary
training from LLVM IR.</p></li>
<li><p><strong>entities</strong>: Generates entity mapping files (entity2id.txt) for vocabulary
training.</p></li>
<li><p><strong>embeddings</strong>: Generates IR2Vec embeddings using a trained vocabulary
at different granularity levels (instruction, basic block, or function).</p></li>
</ol>
<p>The tool is designed to facilitate machine learning applications that work with
LLVM IR by converting the IR into numerical representations that can be used by
ML models. The <cite>triplets</cite> subcommand generates numeric IDs directly instead of string
triplets, streamlining the training data preparation workflow.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For information about using IR2Vec programmatically within LLVM passes and
the C++ API, see the <a class="reference external" href="https://llvm.org/docs/MLGO.html#ir2vec-embeddings">IR2Vec Embeddings</a>
section in the MLGO documentation.</p>
</div>
</section>
<section id="operation-modes">
<h2>OPERATION MODES<a class="headerlink" href="#operation-modes" title="Link to this heading">¶</a></h2>
<p>Triplet Generation and Entity Mapping Modes are used for preparing
vocabulary and training data for knowledge graph embeddings. The Embedding Mode
is used for generating embeddings from LLVM IR using a pre-trained vocabulary.</p>
<p>The Seed Embedding Vocabulary of IR2Vec is trained on a large corpus of LLVM IR
by modeling the relationships between opcodes, types, and operands as a knowledge
graph. For this purpose, Triplet Generation and Entity Mapping Modes generate
triplets and entity mappings in the standard format used for knowledge graph
embedding training (see
&lt;<a class="reference external" href="https://github.com/thunlp/OpenKE/tree/OpenKE-PyTorch?tab=readme-ov-file#data-format">https://github.com/thunlp/OpenKE/tree/OpenKE-PyTorch?tab=readme-ov-file#data-format</a>&gt;
for details).</p>
<p>See <cite>llvm/utils/mlgo-utils/IR2Vec/generateTriplets.py</cite> for more details on how
these two modes are used to generate the triplets and entity mappings.</p>
<section id="triplet-generation">
<h3>Triplet Generation<a class="headerlink" href="#triplet-generation" title="Link to this heading">¶</a></h3>
<p>With the <cite>triplets</cite> subcommand, <strong class="program">llvm-ir2vec</strong> analyzes LLVM IR and extracts
numeric triplets consisting of opcode IDs, type IDs, and operand IDs. These triplets
are generated in the standard format used for knowledge graph embedding training.
The tool outputs numeric IDs directly using the ir2vec::Vocabulary mapping
infrastructure, eliminating the need for string-to-ID preprocessing.</p>
<p>Usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>llvm-ir2vec<span class="w"> </span>triplets<span class="w"> </span>input.bc<span class="w"> </span>-o<span class="w"> </span>triplets_train2id.txt
</pre></div>
</div>
</section>
<section id="entity-mapping-generation">
<h3>Entity Mapping Generation<a class="headerlink" href="#entity-mapping-generation" title="Link to this heading">¶</a></h3>
<p>With the <cite>entities</cite> subcommand, <strong class="program">llvm-ir2vec</strong> generates the entity mappings
supported by IR2Vec in the standard format used for knowledge graph embedding
training. This subcommand outputs all supported entities (opcodes, types, and
operands) with their corresponding numeric IDs, and is not specific for an
LLVM IR file.</p>
<p>Usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>llvm-ir2vec<span class="w"> </span>entities<span class="w"> </span>-o<span class="w"> </span>entity2id.txt
</pre></div>
</div>
</section>
<section id="embedding-generation">
<h3>Embedding Generation<a class="headerlink" href="#embedding-generation" title="Link to this heading">¶</a></h3>
<p>With the <cite>embeddings</cite> subcommand, <strong class="program">llvm-ir2vec</strong> uses a pre-trained vocabulary to
generate numerical embeddings for LLVM IR at different levels of granularity.</p>
<p>Example Usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>llvm-ir2vec<span class="w"> </span>embeddings<span class="w"> </span>--ir2vec-vocab-path<span class="o">=</span>vocab.json<span class="w"> </span>--level<span class="o">=</span>func<span class="w"> </span>input.bc<span class="w"> </span>-o<span class="w"> </span>embeddings.txt
</pre></div>
</div>
</section>
</section>
<section id="options">
<h2>OPTIONS<a class="headerlink" href="#options" title="Link to this heading">¶</a></h2>
<p>Global options:</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-o">
<span class="sig-name descname"><span class="pre">-o</span></span><span class="sig-prename descclassname"> <span class="pre">&lt;filename&gt;</span></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-o" title="Link to this definition">¶</a></dt>
<dd><p>Specify the output filename. Use <code class="docutils literal notranslate"><span class="pre">-</span></code> to write to standard output (default).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-help">
<span class="sig-name descname"><span class="pre">--help</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-help" title="Link to this definition">¶</a></dt>
<dd><p>Print a summary of command line options.</p>
</dd></dl>

<p>Subcommand-specific options:</p>
<p><strong>embeddings</strong> subcommand:</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-arg-input-file">
<span class="sig-name descname"><span class="pre">&lt;input-file&gt;</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-arg-input-file" title="Link to this definition">¶</a></dt>
<dd><p>The input LLVM IR or bitcode file to process. This positional argument is
required for the <cite>embeddings</cite> subcommand.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-level">
<span class="sig-name descname"><span class="pre">--level</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;level&gt;</span></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-level" title="Link to this definition">¶</a></dt>
<dd><p>Specify the embedding generation level. Valid values are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">inst</span></code> - Generate instruction-level embeddings</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bb</span></code> - Generate basic block-level embeddings</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> - Generate function-level embeddings (default)</p></li>
</ul>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-function">
<span class="sig-name descname"><span class="pre">--function</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;name&gt;</span></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-function" title="Link to this definition">¶</a></dt>
<dd><p>Process only the specified function instead of all functions in the module.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-ir2vec-vocab-path">
<span class="sig-name descname"><span class="pre">--ir2vec-vocab-path</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;path&gt;</span></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-ir2vec-vocab-path" title="Link to this definition">¶</a></dt>
<dd><p>Specify the path to the vocabulary file (required for embedding generation).
The vocabulary file should be in JSON format and contain the trained
vocabulary for embedding generation. See <cite>llvm/lib/Analysis/models</cite>
for pre-trained vocabulary files.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-ir2vec-opc-weight">
<span class="sig-name descname"><span class="pre">--ir2vec-opc-weight</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;weight&gt;</span></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-ir2vec-opc-weight" title="Link to this definition">¶</a></dt>
<dd><p>Specify the weight for opcode embeddings (default: 1.0). This controls
the relative importance of instruction opcodes in the final embedding.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-ir2vec-type-weight">
<span class="sig-name descname"><span class="pre">--ir2vec-type-weight</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;weight&gt;</span></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-ir2vec-type-weight" title="Link to this definition">¶</a></dt>
<dd><p>Specify the weight for type embeddings (default: 0.5). This controls
the relative importance of type information in the final embedding.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-ir2vec-arg-weight">
<span class="sig-name descname"><span class="pre">--ir2vec-arg-weight</span></span><span class="sig-prename descclassname"><span class="pre">=&lt;weight&gt;</span></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-ir2vec-arg-weight" title="Link to this definition">¶</a></dt>
<dd><p>Specify the weight for argument embeddings (default: 0.2). This controls
the relative importance of operand information in the final embedding.</p>
</dd></dl>

<p><strong>triplets</strong> subcommand:</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-llvm-ir2vec-arg-0">
<span class="sig-name descname"><span class="pre">&lt;input-file&gt;</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-llvm-ir2vec-arg-0" title="Link to this definition">¶</a></dt>
<dd><p>The input LLVM IR or bitcode file to process. This positional argument is
required for the <cite>triplets</cite> subcommand.</p>
</dd></dl>

<p><strong>entities</strong> subcommand:</p>
<blockquote>
<div><p>No subcommand-specific options.</p>
</div></blockquote>
</section>
<section id="output-format">
<h2>OUTPUT FORMAT<a class="headerlink" href="#output-format" title="Link to this heading">¶</a></h2>
<section id="triplet-mode-output">
<h3>Triplet Mode Output<a class="headerlink" href="#triplet-mode-output" title="Link to this heading">¶</a></h3>
<p>In triplet mode, the output consists of numeric triplets in train2id format with
metadata headers. The format includes:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>MAX_RELATIONS=&lt;max_relations_count&gt;
&lt;head_entity_id&gt; &lt;tail_entity_id&gt; &lt;relation_id&gt;
&lt;head_entity_id&gt; &lt;tail_entity_id&gt; &lt;relation_id&gt;
...
</pre></div>
</div>
<p>Each line after the metadata header represents one instruction relationship,
with numeric IDs for head entity, relation, and tail entity. The metadata
header (MAX_RELATIONS) provides counts for post-processing and training setup.</p>
</section>
<section id="entity-mode-output">
<h3>Entity Mode Output<a class="headerlink" href="#entity-mode-output" title="Link to this heading">¶</a></h3>
<p>In entity mode, the output consists of entity mapping in the format:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>&lt;total_entities&gt;
&lt;entity_string&gt;      &lt;numeric_id&gt;
&lt;entity_string&gt;      &lt;numeric_id&gt;
...
</pre></div>
</div>
<p>The first line contains the total number of entities, followed by one entity
mapping per line with tab-separated entity string and numeric ID.</p>
</section>
<section id="embedding-mode-output">
<h3>Embedding Mode Output<a class="headerlink" href="#embedding-mode-output" title="Link to this heading">¶</a></h3>
<p>In embedding mode, the output format depends on the specified level:</p>
<ul class="simple">
<li><p><strong>Function Level</strong>: One embedding vector per function</p></li>
<li><p><strong>Basic Block Level</strong>: One embedding vector per basic block, grouped by function</p></li>
<li><p><strong>Instruction Level</strong>: One embedding vector per instruction, grouped by basic block and function</p></li>
</ul>
<p>Each embedding is represented as a floating point vector.</p>
</section>
</section>
<section id="exit-status">
<h2>EXIT STATUS<a class="headerlink" href="#exit-status" title="Link to this heading">¶</a></h2>
<p><strong class="program">llvm-ir2vec</strong> returns 0 on success, and a non-zero value on failure.</p>
<p>Common failure cases include:</p>
<ul class="simple">
<li><p>Invalid or missing input file</p></li>
<li><p>Missing or invalid vocabulary file (in embedding mode)</p></li>
<li><p>Specified function not found in the module</p></li>
<li><p>Invalid command line options</p></li>
</ul>
</section>
<section id="see-also">
<h2>SEE ALSO<a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<p><a class="reference internal" href="../MLGO.html"><span class="doc">Machine Learning - Guided Optimization (MLGO)</span></a></p>
<p>For more information about the IR2Vec algorithm and approach, see:
<a class="reference external" href="https://doi.org/10.1145/3418463">IR2Vec: LLVM IR Based Scalable Program Embeddings</a>.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="llvm-lib.html" title="llvm-lib - LLVM lib.exe compatible library tool"
             >next</a> |</li>
        <li class="right" >
          <a href="llvm-dwarfutil.html" title="llvm-dwarfutil - A tool to copy and manipulate debug info"
             >previous</a> |</li>
  <li><a href="https://llvm.org/">LLVM Home</a>&nbsp;|&nbsp;</li>
  <li><a href="../index.html">Documentation</a>&raquo;</li>

          <li class="nav-item nav-item-1"><a href="../Reference.html" >Reference</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >LLVM Command Guide</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">llvm-ir2vec - IR2Vec Embedding Generation Tool</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2003-2025, LLVM Project.
      Last updated on 2025-08-13.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>