<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="LLDB Platform Packets" href="lldbplatformpackets.html" /><link rel="prev" title="DWARF Extensions" href="extensions.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2024.01.29 -->
        <title>GDB Remote Protocol Extensions - üêõ LLDB</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d75fae25" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f0f0f0;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">üêõ LLDB</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">üêõ LLDB</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Using LLDB</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../use/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/map.html">GDB to LLDB command map</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/formatting.html">Frame and Thread Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/variable.html">Variable Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/symbolication.html">Symbolication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/symbols.html">Symbols on macOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/remote.html">Remote Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/intel_pt.html">Tracing with Intel Processor Trace</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/ondemand.html">On Demand Symbols</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/aarch64-linux.html">Using LLDB On AArch64 Linux</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/symbolfilejson.html">JSON Symbol File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/mcp.html">Model Context Protocol (MCP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/links.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../man/lldb.html">Man Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Scripting LLDB</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../use/python.html">Python Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/python-reference.html">Python Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_api.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../python_extensions.html">Python Extensions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developing LLDB</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="test.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="qemu-testing.html">Testing LLDB using QEMU</a></li>
<li class="toctree-l1"><a class="reference internal" href="debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="fuzzing.html">Fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="sbapi.html">Scripting Bridge API</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataformatters.html">Data Formatters</a></li>
<li class="toctree-l1"><a class="reference internal" href="formatterbytecode.html">Formatter Bytecode</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensions.html">DWARF Extensions</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">GDB Remote Protocol Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="lldbplatformpackets.html">LLDB Platform Packets</a></li>
<li class="toctree-l1"><a class="reference internal" href="caveats.html">Caveats</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">Open Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="lldbdap.html">Contributing to LLDB-DAP</a></li>
<li class="toctree-l1"><a class="reference internal" href="addinglanguagesupport.html">Adding Programming Language Support</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/namespacelldb.html">Public C++ API</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lldb.llvm.org/cpp_reference/index.html">Private C++ API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">External Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project">Source Code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/releases">Releases</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discord.gg/xS7Z362">Join the Discord</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discord.com/channels/636084430946959380/636732809708306432">Discord Channel</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discourse.llvm.org/c/subprojects/lldb/8">Discussion Forums</a></li>
<li class="toctree-l1"><a class="reference external" href="https://llvm.org/docs/DeveloperPolicy.html">Developer Policy</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/issues?q=is%3Aissue+label%3Alldb+is%3Aopen">Bug Reports</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/llvm/llvm-project/pulls?q=is%3Apr+label%3Alldb+is%3Aopen">Code Reviews</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/llvm/llvm-project/edit/main/lldb/docs/resources/lldbgdbremote.md" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="gdb-remote-protocol-extensions">
<h1>GDB Remote Protocol Extensions<a class="headerlink" href="#gdb-remote-protocol-extensions" title="Link to this heading">#</a></h1>
<p>LLDB has added new GDB server packets to better support multi-threaded and
remote debugging. These extend the
<a class="reference external" href="https://sourceware.org/gdb/current/onlinedocs/gdb.html/Packets.html#Packets">protocol defined by GDB </a> (and <a class="reference external" href="https://sourceware.org/gdb/current/onlinedocs/gdb.html/Host-I_002fO-Packets.html#Host-I_002fO-Packets">this page</a> for <code class="docutils literal notranslate"><span class="pre">vFile</span></code> packets).</p>
<p>If a packet is restated here it is because LLDB‚Äôs version has some behaviour
difference to GDB‚Äôs version, or it provides some context for a following LLDB
extension packet.</p>
<p>Why did we add these? The most common reason is flexibility. Normally you need
to start the correct GDB and the correct GDB server when debugging. If you have
mismatch, then things go wrong very quickly. LLDB makes extensive use of the GDB
remote protocol and we wanted to make sure that the experience was a bit more
dynamic where we can discover information about a remote target without having
to know anything up front.</p>
<p>We also ran into performance issues with the existing GDB remote
protocol that can be overcome when using a reliable communications layer.</p>
<p>Some packets improve performance, others allow for remote process launching
(if you have an OS), and others allow us to dynamically figure out what
registers a thread might have. Again with GDB, both sides pre-agree on how the
registers will look (how many, their register number,name and offsets).</p>
<p>We prefer to be able to dynamically determine what kind of architecture, OS and
vendor we are debugging, as well as how things are laid out when it comes to
the thread register contexts.</p>
<section id="m-size-permissions">
<h2>_M&lt;size&gt;,&lt;permissions&gt;<a class="headerlink" href="#m-size-permissions" title="Link to this heading">#</a></h2>
<p>Allocate memory on the remote target with the specified size and
permissions.</p>
<p>The allocate memory packet starts with <code class="docutils literal notranslate"><span class="pre">_M&lt;size&gt;,&lt;permissions&gt;</span></code>. It returns a
raw big endian address value, or an empty response for unimplemented, or <code class="docutils literal notranslate"><span class="pre">EXX</span></code> for an error
code. The packet is formatted as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>char packet[256];
int packet_len;
packet_len = ::snprintf (
    packet,
    sizeof(packet),
    &quot;_M%zx,%s%s%s&quot;,
    (size_t)size,
    permissions &amp; lldb::ePermissionsReadable ? &quot;r&quot; : &quot;&quot;,
    permissions &amp; lldb::ePermissionsWritable ? &quot;w&quot; : &quot;&quot;,
    permissions &amp; lldb::ePermissionsExecutable ? &quot;x&quot; : &quot;&quot;);
</pre></div>
</div>
<p>You request a size and give the permissions. This packet does NOT need to be
implemented if you don‚Äôt want to support running JITed code. The return value
is just the address of the newly allocated memory as raw big endian hex bytes.</p>
<p><strong>Priority To Implement:</strong> High if you want LLDB to be able to JIT code and run
that code. JIT code also needs data which is also allocated and tracked. Low if
you don‚Äôt support running JIT‚Äôed code.</p>
</section>
<section id="m-addr">
<h2>_m&lt;addr&gt;<a class="headerlink" href="#m-addr" title="Link to this heading">#</a></h2>
<p>Deallocate memory that was previously allocated using an allocate
memory pack.</p>
<p>The deallocate memory packet is <code class="docutils literal notranslate"><span class="pre">_m&lt;addr&gt;</span></code> where you pass in the address you
got back from a previous call to the allocate memory packet. It returns <code class="docutils literal notranslate"><span class="pre">OK</span></code>
if the memory was successfully deallocated, or <code class="docutils literal notranslate"><span class="pre">EXX</span></code>‚Äù for an error, or an
empty response if not supported.</p>
<p><strong>Priority To Implement:</strong> High if you want LLDB to be able to JIT code and run
that code. JIT code also needs data which is also allocated and tracked. Low if
you don‚Äôt support running JIT‚Äôed code.</p>
</section>
<section id="a-launch-args-packet">
<h2>‚ÄúA‚Äù - launch args packet<a class="headerlink" href="#a-launch-args-packet" title="Link to this heading">#</a></h2>
<p>Launch a program using the supplied arguments</p>
<p>We have added support for the ‚Äúset program arguments‚Äù packet where we can
start a connection to a remote server and then later supply the path to the
executable and the arguments to use when executing:</p>
<p>GDB remote docs for this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">program</span> <span class="n">arguments</span><span class="p">(</span><span class="n">reserved</span><span class="p">)</span> <span class="n">Aarglen</span><span class="p">,</span><span class="n">argnum</span><span class="p">,</span><span class="n">arg</span><span class="p">,</span><span class="o">...</span>
</pre></div>
</div>
<p>Where A is followed by the length in bytes of the hex encoded argument,
followed by an argument integer, and followed by the ASCII characters
converted into hex bytes for each arg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $A98,0,2f566f6c756d65732f776f726b2f67636c6179746f6e2f446f63756d656e74732f7372632f6174746163682f612e6f7574#00
read packet: $OK#00
</pre></div>
</div>
<p>The above packet helps when you have remote debugging abilities where you
could launch a process on a remote host, this isn‚Äôt needed for bare board
debugging.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed if the remote target wants to launch
a target after making a connection to a GDB server that isn‚Äôt already connected to
an inferior process.</p>
</section>
<section id="d-detach-and-stay-stopped">
<h2>‚ÄúD‚Äù - Detach and stay stopped<a class="headerlink" href="#d-detach-and-stay-stopped" title="Link to this heading">#</a></h2>
<p>We extended the ‚ÄúD‚Äù packet to specify that the monitor should keep the
target suspended on detach.  The normal behavior is to resume execution
on detach.  We will send:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qSupportsDetachAndStayStopped</span><span class="p">:</span>
</pre></div>
</div>
<p>to query whether the monitor supports the extended detach, and if it does,
when we want the monitor to detach but not resume the target, we will
send:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D1</span>
</pre></div>
</div>
<p>In any case, if we want the normal detach behavior we will just send:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">D</span>
</pre></div>
</div>
</section>
<section id="jgetdyldprocessstate">
<h2>jGetDyldProcessState<a class="headerlink" href="#jgetdyldprocessstate" title="Link to this heading">#</a></h2>
<p>This packet fetches the process launch state, as reported by libdyld on
Darwin systems, most importantly to indicate when the system libraries
have initialized sufficiently to safely call utility functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LLDB</span> <span class="n">SENDS</span><span class="p">:</span> <span class="n">jGetDyldProcessState</span>
<span class="n">STUB</span> <span class="n">REPLIES</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;process_state_value&quot;</span><span class="p">:</span><span class="mi">48</span><span class="p">,</span><span class="s2">&quot;process_state string&quot;</span><span class="p">:</span><span class="s2">&quot;dyld_process_state_libSystem_initialized&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> Low. This packet is needed to prevent lldb‚Äôs utility
functions for scanning the Objective-C class list from running very early in
process startup.</p>
</section>
<section id="jgetloadeddynamiclibrariesinfos">
<h2>jGetLoadedDynamicLibrariesInfos<a class="headerlink" href="#jgetloadeddynamiclibrariesinfos" title="Link to this heading">#</a></h2>
<p>This packet asks the remote debug stub to send the details about libraries
being added/removed from the process as a performance optimization.</p>
<p>There are two ways this packet can be used.  Both return a dictionary of
binary images formatted the same way.</p>
<p>One requests information on all shared libraries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jGetLoadedDynamicLibrariesInfos</span><span class="p">:{</span><span class="s2">&quot;fetch_all_solibs&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>with an optional <code class="docutils literal notranslate"><span class="pre">&quot;report_load_commands&quot;:false</span></code> which can be added, asking
that only the dyld SPI information (load addresses, filenames) be returned.
The default behavior is that debugserver scans the mach-o header and load
commands of each binary, and returns it in the JSON reply.</p>
<p>And the second requests information about a list of shared libraries, given their load addresses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jGetLoadedDynamicLibrariesInfos</span><span class="p">:{</span><span class="s2">&quot;solib_addresses&quot;</span><span class="p">:[</span><span class="mi">8382824135</span><span class="p">,</span><span class="mi">3258302053</span><span class="p">,</span><span class="mi">830202858503</span><span class="p">]}</span>
</pre></div>
</div>
<p>The second call is both a performance optimization (instead of having lldb read the mach-o header/load commands
out of memory with generic read packets) but also adds additional information in the form of the
filename of the shared libraries (which is not available in the mach-o header/load commands.)</p>
<p>An example using the OS X 10.11 style call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LLDB SENDS: jGetLoadedDynamicLibrariesInfos:{&quot;image_count&quot;:1,&quot;image_list_address&quot;:140734800075128}
STUB REPLIES: ${&quot;images&quot;:[{&quot;load_address&quot;:4294967296,&quot;mod_date&quot;:0,&quot;pathname&quot;:&quot;/tmp/a.out&quot;,&quot;uuid&quot;:&quot;02CF262C-ED6F-3965-9E14-63538B465CFF&quot;,&quot;mach_header&quot;:{&quot;magic&quot;:4277009103,&quot;cputype&quot;:16777223,&quot;cpusubtype&quot;:18446744071562067971,&quot;filetype&quot;:2},&quot;segments&quot;:{&quot;name&quot;:&quot;__PAGEZERO&quot;,&quot;vmaddr&quot;:0,&quot;vmsize&quot;:4294967296,&quot;fileoff&quot;:0,&quot;filesize&quot;:0,&quot;maxprot&quot;:0},{&quot;name&quot;:&quot;__TEXT&quot;,&quot;vmaddr&quot;:4294967296,&quot;vmsize&quot;:4096,&quot;fileoff&quot;:0,&quot;filesize&quot;:4096,&quot;maxprot&quot;:7},{&quot;name&quot;:&quot;__LINKEDIT&quot;,&quot;vmaddr&quot;:4294971392,&quot;vmsize&quot;:4096,&quot;fileoff&quot;:4096,&quot;filesize&quot;:152,&quot;maxprot&quot;:7}}]}#00
</pre></div>
</div>
<p>Or pretty-printed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>STUB REPLIES: ${&quot;images&quot;:
                [
                    {&quot;load_address&quot;:4294967296,
                     &quot;mod_date&quot;:0,
                     &quot;pathname&quot;:&quot;/tmp/a.out&quot;,
                     &quot;uuid&quot;:&quot;02CF262C-ED6F-3965-9E14-63538B465CFF&quot;,
                     &quot;mach_header&quot;:
                        {&quot;magic&quot;:4277009103,
                         &quot;cputype&quot;:16777223,
                         &quot;cpusubtype&quot;:18446744071562067971,
                         &quot;filetype&quot;:2
                         },
                     &quot;segments&quot;:
                      [
                        {&quot;name&quot;:&quot;__PAGEZERO&quot;,
                         &quot;vmaddr&quot;:0,
                         &quot;vmsize&quot;:4294967296,
                         &quot;fileoff&quot;:0,
                         &quot;filesize&quot;:0,
                         &quot;maxprot&quot;:0
                        },
                        {&quot;name&quot;:&quot;__TEXT&quot;,
                         &quot;vmaddr&quot;:4294967296,
                         &quot;vmsize&quot;:4096,
                         &quot;fileoff&quot;:0,
                         &quot;filesize&quot;:4096,
                         &quot;maxprot&quot;:7
                        },
                        {&quot;name&quot;:&quot;__LINKEDIT&quot;,
                         &quot;vmaddr&quot;:4294971392,
                         &quot;vmsize&quot;:4096,
                         &quot;fileoff&quot;:4096,
                         &quot;filesize&quot;:152,
                         &quot;maxprot&quot;:7
                        }
                      ]
                    }
                ]
            }
</pre></div>
</div>
<p>This is similar to the <code class="docutils literal notranslate"><span class="pre">qXfer:libraries:read</span></code> packet, and it could
be argued that it should be merged into that packet.  A separate
packet was created primarily because lldb needs to specify the
number of images to be read and the address from which the initial
information is read.  Also the XML DTD would need to be extended
quite a bit to provide all the information that the <code class="docutils literal notranslate"><span class="pre">DynamicLoaderMacOSX</span></code>
would need to work correctly on this platform.</p>
<p><strong>Priority To Implement:</strong></p>
<p>On OS X 10.11, iOS 9, tvOS 9, watchOS 2 and older: Low.  If this packet is absent,
lldb will read the Mach-O headers/load commands out of memory.
On macOS 10.12, iOS 10, tvOS 10, watchOS 3 and newer: High.  If this packet is absent,
lldb will not know anything about shared libraries in the inferior, or where the main
executable loaded.</p>
</section>
<section id="jgetsharedcacheinfo">
<h2>jGetSharedCacheInfo<a class="headerlink" href="#jgetsharedcacheinfo" title="Link to this heading">#</a></h2>
<p>This packet asks the remote debug stub to send the details about the inferior‚Äôs
shared cache. The shared cache is a collection of common libraries/frameworks that
are mapped into every process at the same address on Darwin systems, and can be
identified by a load address and UUID.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LLDB SENDS: jGetSharedCacheInfo:{}
STUB REPLIES: ${&quot;shared_cache_base_address&quot;:140735683125248,&quot;shared_cache_uuid&quot;:&quot;DDB8D70C-C9A2-3561-B2C8-BE48A4F33F96&quot;,&quot;no_shared_cache&quot;:false,&quot;shared_cache_private_cache&quot;:false]}#00
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> Low</p>
<p>When both lldb and the inferior process are running on the same computer, and lldb
and the inferior process have the same shared cache, lldb may (as an optimization) read
the shared cache out of its own memory instead of using gdb-remote read packets to read
them from the inferior process.</p>
</section>
<section id="jmodulesinfo-file-triple">
<h2>jModulesInfo:[{‚Äúfile‚Äù:‚Äù‚Ä¶‚Äù,triple:‚Äù‚Ä¶‚Äù}, ‚Ä¶]<a class="headerlink" href="#jmodulesinfo-file-triple" title="Link to this heading">#</a></h2>
<p>Get information for a list of modules by given module path and
architecture.</p>
<p>The response is a JSON array of dictionaries containing the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">uuid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">triple</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file_path</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file_offset</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">file_size</span></code></p></li>
</ul>
<p>The meaning of the fields is the same as in the <code class="docutils literal notranslate"><span class="pre">qModuleInfo</span></code> packet. The server
signals the failure to retrieve the module info for a file by ommiting the
corresponding array entry from the response. The server may also
include entries the client did not ask for, if it has reason to
the modules will be interesting to the client.</p>
<p><strong>Priority To Implement:</strong> Optional. If not implemented, <code class="docutils literal notranslate"><span class="pre">qModuleInfo</span></code> packet
will be used, which may be slower if the target contains a large number of modules
and the communication link has a non-negligible latency.</p>
</section>
<section id="jlldbtracegetbinarydata">
<h2>jLLDBTraceGetBinaryData<a class="headerlink" href="#jlldbtracegetbinarydata" title="Link to this heading">#</a></h2>
<p>Get binary data given a trace technology and a data identifier.
The input is specified as a JSON object and the response has the same format
as the ‚Äúbinary memory read‚Äù (aka ‚Äúx‚Äù) packet. In case of failures, an error
message is returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">jLLDBTraceGetBinaryData</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="p">,</span><span class="s2">&quot;kind&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">query</span><span class="o">&gt;</span><span class="p">,</span><span class="s2">&quot;tid&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">tid</span><span class="o">&gt;</span><span class="p">,</span><span class="s2">&quot;offset&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">offset</span><span class="o">&gt;</span><span class="p">,</span><span class="s2">&quot;size&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">size</span><span class="o">&gt;</span><span class="p">}]</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">binary</span> <span class="n">data</span><span class="o">&gt;/</span><span class="n">E</span><span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
<section id="schema">
<h3>Schema<a class="headerlink" href="#schema" title="Link to this heading">#</a></h3>
<p>The schema for the input is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{
 &quot;type&quot;: &lt;string&gt;,
     Tracing technology name, e.g. intel-pt, arm-etm.
 &quot;kind&quot;: &lt;string&gt;,
     Identifier for the data.
 &quot;cpuId&quot;: &lt;Optional decimal&gt;,
     Core id in decimal if the data belongs to a CPU core.
 &quot;tid&quot;?: &lt;Optional decimal&gt;,
     Tid in decimal if the data belongs to a thread.
}
</pre></div>
</div>
</section>
</section>
<section id="jlldbtracegetstate">
<h2>jLLDBTraceGetState<a class="headerlink" href="#jlldbtracegetstate" title="Link to this heading">#</a></h2>
<p>Get the current state of the process and its threads being traced by
a given trace technology. The response is a JSON object with custom
information depending on the trace technology. In case of errors, an
error message is returned.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">jLLDBTraceGetState</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="p">}]</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="p">{</span><span class="o">...</span><span class="n">object</span><span class="p">}</span><span class="o">/</span><span class="n">E</span><span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
<section id="input-schema">
<h3>Input Schema<a class="headerlink" href="#input-schema" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>
      <span class="n">Tracing</span> <span class="n">technology</span> <span class="n">name</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">intel</span><span class="o">-</span><span class="n">pt</span><span class="p">,</span> <span class="n">arm</span><span class="o">-</span><span class="n">etm</span><span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="output-schema">
<h3>Output Schema<a class="headerlink" href="#output-schema" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{
  &quot;tracedThreads&quot;: [{
    &quot;tid&quot;: &lt;decimal integer&gt;,
    &quot;binaryData&quot;: [
      {
        &quot;kind&quot;: &lt;string&gt;,
            Identifier for some binary data related to this thread to
            fetch with the jLLDBTraceGetBinaryData packet.
        &quot;size&quot;: &lt;decimal integer&gt;,
            Size in bytes of this thread data.
      },
    ]
  }],
  &quot;processBinaryData&quot;: [
    {
      &quot;kind&quot;: &lt;string&gt;,
          Identifier for some binary data related to this process to
          fetch with the jLLDBTraceGetBinaryData packet.
      &quot;size&quot;: &lt;decimal integer&gt;,
          Size in bytes of this thread data.
    },
  ],
  &quot;cpus&quot;?: [
    &quot;id&quot;: &lt;decimal integer&gt;,
        Identifier for this CPU logical core.
    &quot;binaryData&quot;: [
      {
        &quot;kind&quot;: &lt;string&gt;,
            Identifier for some binary data related to this thread to
            fetch with the jLLDBTraceGetBinaryData packet.
        &quot;size&quot;: &lt;decimal integer&gt;,
            Size in bytes of this cpu core data.
      },
    ]
  ],
  &quot;warnings&quot;?: [&lt;string&gt;],
      Non-fatal messages useful for troubleshooting.

  ... other attributes specific to the given tracing technology
}
</pre></div>
</div>
<p><strong>Note:</strong> <code class="docutils literal notranslate"><span class="pre">tracedThreads</span></code> includes all threads traced by both ‚Äúprocess tracing‚Äù
and ‚Äúthread tracing‚Äù.</p>
</section>
<section id="intel-pt">
<h3>Intel Pt<a class="headerlink" href="#intel-pt" title="Link to this heading">#</a></h3>
<p>If per-cpu process tracing is enabled, ‚ÄútracedThreads‚Äù will contain all
the threads of the process without any trace buffers. Besides that, the
‚Äúcpus‚Äù field will also be returned with per cpu core trace buffers.
A side effect of per-cpu tracing is that all the threads of unrelated
processes will also be traced, thus polluting the tracing data.</p>
<p>Binary data kinds:</p>
<ul class="simple">
<li><p>iptTrace: trace buffer for a thread or a cpu.</p></li>
<li><p>perfContextSwitchTrace: context switch trace for a cpu generated by
perf_event_open.</p></li>
<li><p>procfsCpuInfo: contents of the /proc/cpuinfo file.</p></li>
</ul>
<p>Additional attributes:</p>
<ul>
<li><p>tscPerfZeroConversion</p>
<ul>
<li><p>This field allows converting Intel processor‚Äôs TSC values to nanoseconds.
It is available through the Linux perf_event API when cap_user_time and cap_user_time_zero
are set.
See the documentation of time_zero in
https://man7.org/linux/man-pages/man2/perf_event_open.2.html for more information about
the calculation and the meaning of the values in the schema below.</p>
<p>Schema for this field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;tscPerfZeroConversion&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="s2">&quot;timeMult&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">decimal</span> <span class="n">integer</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="s2">&quot;timeShift&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">decimal</span> <span class="n">integer</span><span class="o">&gt;</span><span class="p">,</span>
  <span class="s2">&quot;timeZero&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">decimal</span> <span class="n">integer</span><span class="o">&gt;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</section>
</section>
<section id="jlldbtracestart">
<h2>jLLDBTraceStart<a class="headerlink" href="#jlldbtracestart" title="Link to this heading">#</a></h2>
<p>Start tracing a process or its threads using a provided tracing technology.
The input and output are specified as JSON objects. In case of success, an OK
response is returned, or an error otherwise.</p>
<section id="process-tracing">
<h3>Process Tracing<a class="headerlink" href="#process-tracing" title="Link to this heading">#</a></h3>
<p>This traces existing and future threads of the current process. An error is
returned if the process is already being traced.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">jLLDBTraceStart</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="p">,</span><span class="o">...</span><span class="n">other</span> <span class="n">params</span><span class="p">}]</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span><span class="o">/</span><span class="n">E</span><span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
</section>
<section id="thread-tracing">
<h3>Thread Tracing<a class="headerlink" href="#thread-tracing" title="Link to this heading">#</a></h3>
<p>This traces specific threads.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">jLLDBTraceStart</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="p">,</span><span class="s2">&quot;tids&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">tids</span><span class="o">&gt;</span><span class="p">,</span><span class="o">...</span><span class="n">other</span> <span class="n">params</span><span class="p">}]</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span><span class="o">/</span><span class="n">E</span><span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
</section>
<section id="id1">
<h3>Input Schema<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{
  &quot;type&quot;: &lt;string&gt;,
      Tracing technology name, e.g. intel-pt, arm-etm.

  /* thread tracing only */
  &quot;tids&quot;?: [&lt;decimal integer&gt;],
      Individual threads to trace.

  ... other parameters specific to the provided tracing type
}
</pre></div>
</div>
<p><strong>Notes:</strong></p>
<ul class="simple">
<li><p>If ‚Äútids‚Äù is not provided, then the operation is ‚Äúprocess tracing‚Äù,
otherwise it‚Äôs ‚Äúthread tracing‚Äù.</p></li>
<li><p>Each tracing technology can have different levels of support for ‚Äúthread
tracing‚Äù and ‚Äúprocess tracing‚Äù.</p></li>
</ul>
</section>
<section id="id2">
<h3>Intel-Pt<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<p>intel-pt supports both ‚Äúthread tracing‚Äù and ‚Äúprocess tracing‚Äù.</p>
<p>‚ÄúProcess tracing‚Äù is implemented in two different ways. If the
‚ÄúperCpuTracing‚Äù option is false, then each thread is traced individually
but managed by the same ‚Äúprocess trace‚Äù instance. This means that the
amount of trace buffers used is proportional to the number of running
threads. This is the recommended option unless the number of threads is
huge. If ‚ÄúperCpuTracing‚Äù is true, then each cpu core is traced invidually
instead of each thread, which uses a fixed number of trace buffers, but
might result in less data available for less frequent threads. See
‚ÄúperCpuTracing‚Äù below for more information.</p>
<p>Each actual intel pt trace buffer, either from ‚Äúprocess tracing‚Äù or ‚Äúthread
tracing‚Äù, is stored in an in-memory circular buffer, which keeps the most
recent data.</p>
<p>Additional params in the input schema:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> {
   &quot;iptTraceSize&quot;: &lt;decimal integer&gt;,
       Size in bytes used by each individual per-thread or per-cpu trace
       buffer. It must be a power of 2 greater than or equal to 4096 (2^12)
       bytes.

   &quot;enableTsc&quot;: &lt;boolean&gt;,
       Whether to enable TSC timestamps or not. This is supported on
       all devices that support intel-pt. A TSC timestamp is generated along
       with PSB (synchronization) packets, whose frequency can be configured
       with the &quot;psbPeriod&quot; parameter.

   &quot;psbPeriod&quot;?: &lt;Optional decimal integer&gt;,
       This value defines the period in which PSB packets will be generated.
       A PSB packet is a synchronization packet that contains a TSC
       timestamp and the current absolute instruction pointer.

       This parameter can only be used if

           /sys/bus/event_source/devices/intel_pt/caps/psb_cyc

       is 1. Otherwise, the PSB period will be defined by the processor.

       If supported, valid values for this period can be found in

           /sys/bus/event_source/devices/intel_pt/caps/psb_periods

       which contains a hexadecimal number, whose bits represent valid
       values e.g. if bit 2 is set, then value 2 is valid.

       The psb_period value is converted to the approximate number of
       raw trace bytes between PSB packets as:

           2 ^ (value + 11)

        e.g. value 3 means 16KiB between PSB packets. Defaults to
        0 if supported.

   /* process tracing only */
   &quot;perCpuTracing&quot;: &lt;boolean&gt;
       Instead of having an individual trace buffer per thread, this option
       triggers the collection on a per cpu core basis. This effectively
       traces the entire activity on all cores. At decoding time, in order
       to correctly associate a decoded instruction with a thread, the
       context switch trace of each core is needed, as well as a record per
       cpu indicating which thread was running on each core when tracing
       started. These secondary traces are correlated with the intel-pt
       trace by comparing TSC timestamps.

       This option forces the capture of TSC timestamps (see &quot;enableTsc&quot;).

       Note: This option can&#39;t be used simulatenously with any other trace
       sessions because of its system-wide nature.

   /* process tracing only */
   &quot;processBufferSizeLimit&quot;: &lt;decimal integer&gt;,
       Maximum total buffer size per process in bytes.
       This limit applies to the sum of the sizes of all thread or cpu core
       buffers for the current process, excluding the ones started with
       &quot;thread tracing&quot;.

       If &quot;perCpuTracing&quot; is false, whenever a thread is attempted to be
       traced due to &quot;process tracing&quot; and the limit would be reached, the
       process is stopped with a &quot;tracing&quot; reason along with a meaningful
       description, so that the user can retrace the process if needed.

       If &quot;perCpuTracing&quot; is true, then starting the system-wide trace
       session fails if all the individual per-cpu trace buffers require
       in total more memory that the limit impossed by this parameter.
 }
</pre></div>
</div>
<p>Notes:</p>
<ul class="simple">
<li><p>Modifying the parameters of an existing trace is not supported. The user
needs to stop the trace and start a new one.</p></li>
<li><p>If ‚Äúprocess tracing‚Äù is attempted and there are individual threads
already being traced with ‚Äúthread tracing‚Äù, these traces are left
unaffected and the threads not traced twice.</p></li>
<li><p>If ‚Äúthread tracing‚Äù is attempted on a thread already being traced with
either ‚Äúthread tracing‚Äù or ‚Äúprocess tracing‚Äù, it fails.</p></li>
</ul>
</section>
</section>
<section id="jlldbtracestop">
<h2>jLLDBTraceStop<a class="headerlink" href="#jlldbtracestop" title="Link to this heading">#</a></h2>
<p>Stop tracing a process or its threads using a provided tracing technology.
The input and output are specified as JSON objects. In case of success, an OK
response is returned, or an error otherwise.</p>
<section id="process-trace-stopping">
<h3>Process Trace Stopping<a class="headerlink" href="#process-trace-stopping" title="Link to this heading">#</a></h3>
<p>Stopping a process trace stops the active traces initiated with
‚Äúthread tracing‚Äù.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">jLLDBTraceStop</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="p">}]</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span><span class="o">/</span><span class="n">E</span><span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
</section>
<section id="thread-trace-stopping">
<h3>Thread Trace Stopping<a class="headerlink" href="#thread-trace-stopping" title="Link to this heading">#</a></h3>
<p>This is a best effort request, which tries to stop as many traces as
possible.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">jLLDBTraceStop</span><span class="p">:{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="p">,</span><span class="s2">&quot;tids&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">tids</span><span class="o">&gt;</span><span class="p">}]</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span><span class="o">/</span><span class="n">E</span><span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Input Schema<a class="headerlink" href="#id3" title="Link to this heading">#</a></h3>
<p>The schema for the input is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span>
     <span class="n">Tracing</span> <span class="n">technology</span> <span class="n">name</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">intel</span><span class="o">-</span><span class="n">pt</span><span class="p">,</span> <span class="n">arm</span><span class="o">-</span><span class="n">etm</span><span class="o">.</span>

  <span class="o">/*</span> <span class="n">thread</span> <span class="n">trace</span> <span class="n">stopping</span> <span class="n">only</span> <span class="o">*/</span>
  <span class="s2">&quot;tids&quot;</span><span class="p">:</span>  <span class="p">[</span><span class="o">&lt;</span><span class="n">decimal</span> <span class="n">integer</span><span class="o">&gt;</span><span class="p">]</span>
     <span class="n">Individual</span> <span class="n">thread</span> <span class="n">traces</span> <span class="n">to</span> <span class="n">stop</span><span class="o">.</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note:</strong> If <code class="docutils literal notranslate"><span class="pre">tids</span></code> is not provided, then the operation is ‚Äúprocess trace stopping‚Äù.</p>
</section>
<section id="id4">
<h3>Intel Pt<a class="headerlink" href="#id4" title="Link to this heading">#</a></h3>
<p>Stopping a specific thread trace started with ‚Äúprocess tracing‚Äù is allowed.</p>
</section>
</section>
<section id="jlldbtracesupported">
<h2>jLLDBTraceSupported<a class="headerlink" href="#jlldbtracesupported" title="Link to this heading">#</a></h2>
<p>Get the processor tracing type supported by the gdb-server for the current
inferior. Responses might be different depending on the architecture and
capabilities of the underlying OS.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">jLLDBTraceSupported</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="p">}</span><span class="o">/</span><span class="n">E</span><span class="o">&lt;</span><span class="n">error</span> <span class="n">code</span><span class="o">&gt;</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
<section id="id5">
<h3>Output Schema<a class="headerlink" href="#id5" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
   <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
       <span class="n">Tracing</span> <span class="n">technology</span> <span class="n">name</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="n">intel</span><span class="o">-</span><span class="n">pt</span><span class="p">,</span> <span class="n">arm</span><span class="o">-</span><span class="n">etm</span><span class="o">.</span>
   <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">,</span>
       <span class="n">Description</span> <span class="k">for</span> <span class="n">this</span> <span class="n">technology</span><span class="o">.</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>If no tracing technology is supported for the inferior, or no process is
running, then an error message is returned.</p>
<p><strong>Note:</strong> This packet is used by Trace plug-ins (see <code class="docutils literal notranslate"><span class="pre">lldb_private::Trace.h</span></code>) to
do live tracing. Specifically, the name of the plug-in should match the name
of the tracing technology returned by this packet.</p>
</section>
</section>
<section id="jthreadextendedinfo">
<h2>jThreadExtendedInfo<a class="headerlink" href="#jthreadextendedinfo" title="Link to this heading">#</a></h2>
<p>This packet, which takes its arguments as JSON and sends its reply as
JSON, allows the gdb remote stub to provide additional information
about a given thread.</p>
<p>This packet takes its arguments in <a class="reference external" href="http://www.json.org">JSON</a>.
At a minimum, a thread must be specified, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jThreadExtendedInfo</span><span class="p">:{</span><span class="s2">&quot;thread&quot;</span><span class="p">:</span><span class="mi">612910</span><span class="p">}</span>
</pre></div>
</div>
<p>Because this is a JSON string, the thread number is provided in base 10.
Additional key-value pairs may be provided by lldb to the gdb remote
stub.  For instance, on some versions of macOS, lldb can read offset
information out of the system libraries.  Using those offsets, debugserver
is able to find the Thread Specific Address (TSD) for a thread and include
that in the return information.  So lldb will send these additional fields
like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jThreadExtendedInfo</span><span class="p">:{</span><span class="s2">&quot;plo_pthread_tsd_base_address_offset&quot;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="s2">&quot;plo_pthread_tsd_base_offset&quot;</span><span class="p">:</span><span class="mi">224</span><span class="p">,</span><span class="s2">&quot;plo_pthread_tsd_entry_size&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="s2">&quot;thread&quot;</span><span class="p">:</span><span class="mi">612910</span><span class="p">}</span>
</pre></div>
</div>
<p>There are no requirements for what is included in the response.  A simple
reply on a OS X Yosemite / iOS 8 may include the pthread_t value, the
Thread Specific Data (TSD) address, the dispatch_queue_t value if the thread
is associated with a GCD queue, and the requested Quality of Service (QoS)
information about that thread.  For instance, a reply may look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;tsd_address&quot;</span><span class="p">:</span><span class="mi">4371349728</span><span class="p">,</span><span class="s2">&quot;requested_qos&quot;</span><span class="p">:{</span><span class="s2">&quot;enum_value&quot;</span><span class="p">:</span><span class="mi">33</span><span class="p">,</span><span class="s2">&quot;constant_name&quot;</span><span class="p">:</span><span class="s2">&quot;QOS_CLASS_USER_INTERACTIVE&quot;</span><span class="p">,</span><span class="s2">&quot;printable_name&quot;</span><span class="p">:</span><span class="s2">&quot;User Interactive&quot;</span><span class="p">},</span><span class="s2">&quot;pthread_t&quot;</span><span class="p">:</span><span class="mi">4371349504</span><span class="p">,</span><span class="s2">&quot;dispatch_queue_t&quot;</span><span class="p">:</span><span class="mi">140735087127872</span><span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">tsd_address</span></code>, <code class="docutils literal notranslate"><span class="pre">pthread_t</span></code>, and <code class="docutils literal notranslate"><span class="pre">dispatch_queue_t</span></code> are all simple key-value pairs.
The JSON standard requires that numbers be expressed in base 10 - so all of
these are. <code class="docutils literal notranslate"><span class="pre">requested_qos</span></code> is a dictionary with three key-value pairs in it -
so the UI layer may choose the form most appropriate for displaying to the user.</p>
<p>Sending JSON over gdb-remote protocol introduces some problems.  We may be
sending strings with arbitrary contents in them, including the <code class="docutils literal notranslate"><span class="pre">#</span></code>, <code class="docutils literal notranslate"><span class="pre">$</span></code>, and <code class="docutils literal notranslate"><span class="pre">*</span></code>
characters that have special meaning in gdb-remote protocol and cannot occur
in the middle of the string. The standard solution for this would be to require
ascii-hex encoding of all strings, or ascii-hex encode the entire JSON payload.</p>
<p>Instead, the binary escaping convention is used for JSON data.  This convention
(e.g. used for the <code class="docutils literal notranslate"><span class="pre">X</span></code> packet) says that if <code class="docutils literal notranslate"><span class="pre">#</span></code>, <code class="docutils literal notranslate"><span class="pre">$</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, or <code class="docutils literal notranslate"><span class="pre">}</span></code> are to occur in
the payload, the character <code class="docutils literal notranslate"><span class="pre">}</span></code> (<code class="docutils literal notranslate"><span class="pre">0x7d</span></code>) is emitted, then the metacharacter is emitted
xor‚Äôed by <code class="docutils literal notranslate"><span class="pre">0x20</span></code>. The <code class="docutils literal notranslate"><span class="pre">}</span></code> character occurs in every JSON payload at least once, and
<code class="docutils literal notranslate"><span class="pre">}</span> <span class="pre">^</span> <span class="pre">0x20</span></code> happens to be <code class="docutils literal notranslate"><span class="pre">]</span></code> so the raw packet characters for a request will look
like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jThreadExtendedInfo</span><span class="p">:{</span><span class="s2">&quot;thread&quot;</span><span class="p">:</span><span class="mi">612910</span><span class="p">}]</span>
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> Low. This packet is only needed if the gdb remote stub
wants to provide interesting additional information about a thread for the user.</p>
</section>
<section id="jthreadsinfo">
<h2>jThreadsInfo<a class="headerlink" href="#jthreadsinfo" title="Link to this heading">#</a></h2>
<p>Ask for the server for thread stop information of all threads.</p>
<p>The data in this packet is very similar to the stop reply packets, but is packaged in
JSON and uses JSON arrays where applicable. The JSON output looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="p">[</span>
      <span class="p">{</span> <span class="s2">&quot;tid&quot;</span><span class="p">:</span><span class="mi">1580681</span><span class="p">,</span>
        <span class="s2">&quot;metype&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
        <span class="s2">&quot;medata&quot;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
        <span class="s2">&quot;reason&quot;</span><span class="p">:</span><span class="s2">&quot;exception&quot;</span><span class="p">,</span>
        <span class="s2">&quot;qaddr&quot;</span><span class="p">:</span><span class="mi">140735118423168</span><span class="p">,</span>
        <span class="s2">&quot;registers&quot;</span><span class="p">:</span> <span class="p">{</span>
          <span class="s2">&quot;0&quot;</span><span class="p">:</span><span class="s2">&quot;8000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;1&quot;</span><span class="p">:</span><span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;2&quot;</span><span class="p">:</span><span class="s2">&quot;20fabf5fff7f0000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;3&quot;</span><span class="p">:</span><span class="s2">&quot;e8f8bf5fff7f0000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;4&quot;</span><span class="p">:</span><span class="s2">&quot;0100000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;5&quot;</span><span class="p">:</span><span class="s2">&quot;d8f8bf5fff7f0000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;6&quot;</span><span class="p">:</span><span class="s2">&quot;b0f8bf5fff7f0000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;7&quot;</span><span class="p">:</span><span class="s2">&quot;20f4bf5fff7f0000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;8&quot;</span><span class="p">:</span><span class="s2">&quot;8000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;9&quot;</span><span class="p">:</span><span class="s2">&quot;61a8db78a61500db&quot;</span><span class="p">,</span>
          <span class="s2">&quot;10&quot;</span><span class="p">:</span><span class="s2">&quot;3200000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;11&quot;</span><span class="p">:</span><span class="s2">&quot;4602000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;12&quot;</span><span class="p">:</span><span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;13&quot;</span><span class="p">:</span><span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;14&quot;</span><span class="p">:</span><span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;15&quot;</span><span class="p">:</span><span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;16&quot;</span><span class="p">:</span><span class="s2">&quot;960b000001000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;17&quot;</span><span class="p">:</span><span class="s2">&quot;0202000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;18&quot;</span><span class="p">:</span><span class="s2">&quot;2b00000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;19&quot;</span><span class="p">:</span><span class="s2">&quot;0000000000000000&quot;</span><span class="p">,</span>
          <span class="s2">&quot;20&quot;</span><span class="p">:</span><span class="s2">&quot;0000000000000000&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;memory&quot;</span><span class="p">:[</span>
          <span class="p">{</span><span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="mi">140734799804592</span><span class="p">,</span><span class="s2">&quot;bytes&quot;</span><span class="p">:</span><span class="s2">&quot;c8f8bf5fff7f0000c9a59e8cff7f0000&quot;</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="mi">140734799804616</span><span class="p">,</span><span class="s2">&quot;bytes&quot;</span><span class="p">:</span><span class="s2">&quot;00000000000000000100000000000000&quot;</span><span class="p">}</span>
        <span class="p">]</span>
      <span class="p">}</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>It contains an array of dictionaries with all of the key value pairs that are
normally in the stop reply packet, including the expedited registers. The registers are
passed as hex-encoded JSON string in debuggee-endian byte order. Note that the register
numbers are decimal numbers, unlike the stop-reply packet, where they are written in
hex. The packet also contains expedited memory in the <code class="docutils literal notranslate"><span class="pre">memory</span></code> key.  This allows the
server to expedite memory that the client is likely to use (e.g., areas around the
stack pointer, which are needed for computing backtraces) and it reduces the packet
count.</p>
<p>On macOS with debugserver, we expedite the frame pointer backchain for a thread
(up to 256 entries) by reading 2 pointers worth of bytes at the frame pointer (for
the previous FP and PC), and follow the backchain. Most backtraces on macOS and
iOS now don‚Äôt require us to read any memory!</p>
<p><strong>Priority To Implement:</strong> Low</p>
<p>This is a performance optimization, which speeds up debugging by avoiding
multiple round-trips for retrieving thread information. The information from this
packet can be retrieved using a combination of <code class="docutils literal notranslate"><span class="pre">qThreadStopInfo</span></code> and <code class="docutils literal notranslate"><span class="pre">m</span></code> packets.</p>
</section>
<section id="qenvironment-name-value">
<h2>QEnvironment:NAME=VALUE<a class="headerlink" href="#qenvironment-name-value" title="Link to this heading">#</a></h2>
<p>Setup the environment up for a new child process that will soon be
launched using the ‚ÄúA‚Äù packet.</p>
<p>NB: key/value pairs are sent as-is so gdb-remote protocol meta characters
(e.g. <code class="docutils literal notranslate"><span class="pre">#</span></code> or <code class="docutils literal notranslate"><span class="pre">$</span></code>) are not acceptable.  If any non-printable or
metacharacters are present in the strings, <code class="docutils literal notranslate"><span class="pre">QEnvironmentHexEncoded</span></code>
should be used instead if it is available.  If you don‚Äôt want to
scan the environment strings before sending, prefer
the <code class="docutils literal notranslate"><span class="pre">QEnvironmentHexEncoded</span></code> packet over <code class="docutils literal notranslate"><span class="pre">QEnvironment</span></code>, if it is
available.</p>
<p>Both GDB and LLDB support passing down environment variables. Is it ok to
respond with a <code class="docutils literal notranslate"><span class="pre">$#00</span></code> (unimplemented):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $QEnvironment:ACK_COLOR_FILENAME=bold yellow#00
read packet: $OK#00
</pre></div>
</div>
<p>This packet can be sent one or more times <em>prior</em> to sending a ‚ÄúA‚Äù packet.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed if the remote target wants to launch
a target after making a connection to a GDB server that isn‚Äôt already connected to
an inferior process.</p>
</section>
<section id="qenvironmenthexencoded-hex-encoding-name-value">
<h2>QEnvironmentHexEncoded:HEX-ENCODING(NAME=VALUE)<a class="headerlink" href="#qenvironmenthexencoded-hex-encoding-name-value" title="Link to this heading">#</a></h2>
<p>Setup the environment up for a new child process that will soon be
launched using the ‚ÄúA‚Äù packet.</p>
<p>The only difference between this packet and <code class="docutils literal notranslate"><span class="pre">QEnvironment</span></code> is that the
environment key-value pair is ascii hex encoded for transmission.
This allows values with gdb-remote metacharacters like <code class="docutils literal notranslate"><span class="pre">#</span></code> to be sent.</p>
<p>Both GDB and LLDB support passing down environment variables. Is it ok to
respond with a <code class="docutils literal notranslate"><span class="pre">$#00</span></code> (unimplemented):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $QEnvironment:41434b5f434f4c4f525f46494c454e414d453d626f6c642379656c6c6f77#00
read packet: $OK#00
</pre></div>
</div>
<p>This packet can be sent one or more times <em>prior</em> to sending a ‚ÄúA‚Äù packet.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed if the remote target wants to launch
a target after making a connection to a GDB server that isn‚Äôt already connected to
an inferior process.</p>
</section>
<section id="qenablecompression">
<h2>QEnableCompression<a class="headerlink" href="#qenablecompression" title="Link to this heading">#</a></h2>
<p>This packet enables compression of the packets that the debug stub sends to lldb.
If the debug stub can support compression, it indictes this in the reply of the
‚ÄúqSupported‚Äù packet. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LLDB</span> <span class="n">SENDS</span><span class="p">:</span>    <span class="n">qSupported</span><span class="p">:</span><span class="n">xmlRegisters</span><span class="o">=</span><span class="n">i386</span><span class="p">,</span><span class="n">arm</span><span class="p">,</span><span class="n">mips</span>
<span class="n">STUB</span> <span class="n">REPLIES</span><span class="p">:</span>  <span class="n">qXfer</span><span class="p">:</span><span class="n">features</span><span class="p">:</span><span class="n">read</span><span class="o">+</span><span class="p">;</span><span class="n">SupportedCompressions</span><span class="o">=</span><span class="n">lzfse</span><span class="p">,</span><span class="n">zlib</span><span class="o">-</span><span class="n">deflate</span><span class="p">,</span><span class="n">lz4</span><span class="p">,</span><span class="n">lzma</span><span class="p">;</span>
</pre></div>
</div>
<p>If lldb knows how to use any of these compression algorithms, it can ask that this
compression mode be enabled.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QEnableCompression</span><span class="p">:</span><span class="nb">type</span><span class="p">:</span><span class="n">zlib</span><span class="o">-</span><span class="n">deflate</span><span class="p">;</span>
</pre></div>
</div>
<p>The debug stub should reply with an uncompressed <code class="docutils literal notranslate"><span class="pre">OK</span></code> packet to indicate that the
request was accepted.  All further packets the stub sends will use this compression.</p>
<p>Packets are compressed as the last step before they are sent from the stub, and
decompressed as the first step after they are received.  The packet format in compressed
mode becomes one of two:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$N&lt;uncompressed payload&gt;#00

$C&lt;size of uncompressed payload in base 10&gt;:&lt;compressed payload&gt;#00
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">#00</span></code> is the actual checksum value if noack mode is not enabled. The checksum
value is for the <code class="docutils literal notranslate"><span class="pre">N&lt;uncompressed</span> <span class="pre">payload&gt;</span></code> or
<code class="docutils literal notranslate"><span class="pre">C&lt;size</span> <span class="pre">of</span> <span class="pre">uncompressed</span> <span class="pre">payload</span> <span class="pre">in</span> <span class="pre">base</span> <span class="pre">10&gt;:&lt;compressed</span> <span class="pre">payload&gt;</span></code> bytes in the packet.</p>
<p>The size of the uncompressed payload in base 10 is provided because it will simplify
decompression if the final buffer size needed is known ahead of time.</p>
<p>Compression on low-latency connections is unlikely to be an improvement. Particularly
when the debug stub and lldb are running on the same host. It should only be used
for slow connections, and likely only for larger packets.</p>
<p>Example compression algorithms that may be used include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">zlib-deflate</span></code> -
The raw DEFLATE format as described in IETF RFC 1951.  With the ZLIB library, you
can compress to this format with an initialization like
deflateInit2 (&amp;stream, 5, Z_DEFLATED, -15, 8, Z_DEFAULT_STRATEGY)
and you can decompress with an initialization like
inflateInit2 (&amp;stream, -15).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lz4</span></code> -
https://en.wikipedia.org/wiki/LZ4_(compression_algorithm)
https://github.com/Cyan4973/lz4
The libcompression APIs on darwin systems call this <code class="docutils literal notranslate"><span class="pre">COMPRESSION_LZ4_RAW</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lzfse</span></code> -
Compression algorithm added in macOS 10.11, with open source C reference
implementation on github.
https://en.wikipedia.org/wiki/LZFSE
https://github.com/lzfse/lzfse</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lzma</span></code> -
libcompression implements ‚ÄúLZMA level 6‚Äù, the default compression for the
open source LZMA implementation.</p></li>
</ul>
</section>
<section id="qenableerrorstrings">
<h2>QEnableErrorStrings<a class="headerlink" href="#qenableerrorstrings" title="Link to this heading">#</a></h2>
<p>This packet enables reporting of Error strings in remote packet
replies from the server to client. If the server supports this
feature, it should send an OK response.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $QEnableErrorStrings
read packet: $OK#00
</pre></div>
</div>
<p>The client can expect the following error replies if this feature is enabled in
the server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">EXX</span><span class="p">;</span><span class="n">AAAAAAAAA</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">AAAAAAAAA</span></code> will be a hex encoded ASCII string.
`XX`` is hex encoded byte number.</p>
<p>It must be noted that even if the client has enabled reporting
strings in error replies, it must not expect error strings to all
error replies.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed if the remote target wants to
provide strings that are human readable along with an error code.</p>
</section>
<section id="qlauncharch">
<h2>QLaunchArch<a class="headerlink" href="#qlauncharch" title="Link to this heading">#</a></h2>
<p>Set the architecture to use when launching a process for hosts that can run
multiple architecture slices that are contained in a single universal program
file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $QLaunchArch:&lt;architecture&gt;
</pre></div>
</div>
<p>The response is <code class="docutils literal notranslate"><span class="pre">OK</span></code> if the value in <code class="docutils literal notranslate"><span class="pre">&lt;architecture&gt;</span></code> was recognised as valid
and will be used for the next launch request. <code class="docutils literal notranslate"><span class="pre">E63</span></code> if not.</p>
<p><strong>Priority To Implement:</strong> Only required for hosts that support program files
that contain code for multiple architectures.</p>
</section>
<section id="qlistthreadsinstopreply">
<h2>QListThreadsInStopReply<a class="headerlink" href="#qlistthreadsinstopreply" title="Link to this heading">#</a></h2>
<p>Enable the <code class="docutils literal notranslate"><span class="pre">threads:</span></code> and <code class="docutils literal notranslate"><span class="pre">thread-pcs:</span></code> data in the question-mark packet
(‚ÄúT packet‚Äù) responses when the stub reports that a program has
stopped executing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">QListThreadsInStopReply</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span>
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> Performance.  This is a performance benefit to lldb
if the thread id‚Äôs and thread pc values are provided to lldb in the T stop packet
‚Äì if they are not provided to lldb, lldb will likely need to send one to
two packets per thread to fetch the data at every private stop.</p>
</section>
<section id="qrestoreregisterstate-save-id-qrestoreregisterstate-save-id-thread-xxxx">
<h2>QRestoreRegisterState:&lt;save_id&gt; / QRestoreRegisterState:&lt;save_id&gt;;thread:XXXX;<a class="headerlink" href="#qrestoreregisterstate-save-id-qrestoreregisterstate-save-id-thread-xxxx" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">QRestoreRegisterState</span></code> packet tells the remote debugserver to
restore all registers using the <code class="docutils literal notranslate"><span class="pre">save_id</span></code> which is an unsigned
integer that was returned from a previous call to
<code class="docutils literal notranslate"><span class="pre">QSaveRegisterState</span></code>. The restoration process can only be done once
as the data backing the register state will be freed upon the
completion of the <code class="docutils literal notranslate"><span class="pre">QRestoreRegisterState</span></code> command.</p>
<p>If thread suffixes are enabled the second form of this packet is
used, otherwise the first form is used.</p>
<p>The response is either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">OK</span></code> - if all registers were successfully restored</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXX</span></code> - for any errors</p></li>
</ul>
<p><strong>Priority To Implement:</strong> Low, this is mostly a convenience packet to avoid
having to send all registers with a <code class="docutils literal notranslate"><span class="pre">g</span></code> packet. It should only be implemented
if support for the <code class="docutils literal notranslate"><span class="pre">QSaveRegisterState</span></code> is added.</p>
</section>
<section id="qsaveregisterstate-qsaveregisterstate-thread-xxxx">
<h2>QSaveRegisterState / QSaveRegisterState;thread:XXXX;<a class="headerlink" href="#qsaveregisterstate-qsaveregisterstate-thread-xxxx" title="Link to this heading">#</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">QSaveRegisterState</span></code> packet tells the remote debugserver to save
all registers and return a non-zero unique integer ID that
represents these save registers. If thread suffixes are enabled the
second form of this packet is used, otherwise the first form is
used. This packet is called prior to executing an expression, so
the remote GDB server should do anything it needs to in order to
ensure the registers that are saved are correct. On macOS this
involves calling <code class="docutils literal notranslate"><span class="pre">thread_abort_safely(mach_port_t</span> <span class="pre">thread)</span></code> to
ensure we get the correct registers for a thread in case it is
currently having code run on its behalf in the kernel.</p>
<p>The response is either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;unsigned</span> <span class="pre">int&gt;</span></code> - The save_id result is a non-zero unsigned integer value
that can be passed back to the GDB server using a
<code class="docutils literal notranslate"><span class="pre">QRestoreRegisterState</span></code> packet to restore the registers
one time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXX</span></code> - or an error code in the form of <code class="docutils literal notranslate"><span class="pre">EXX</span></code> where <code class="docutils literal notranslate"><span class="pre">XX</span></code> is a
hex error code.</p></li>
</ul>
<p><strong>Priority To Implement:</strong> Low, this is mostly a convenience packet to avoid
having to send all registers with a <code class="docutils literal notranslate"><span class="pre">g</span></code> packet. It should only be implemented if
support for the <code class="docutils literal notranslate"><span class="pre">QRestoreRegisterState</span></code> is added.</p>
</section>
<section id="qsetdetachonerror">
<h2>QSetDetachOnError<a class="headerlink" href="#qsetdetachonerror" title="Link to this heading">#</a></h2>
<p>Sets what the server should do when the communication channel with LLDB
goes down. Either kill the inferior process (<code class="docutils literal notranslate"><span class="pre">0</span></code>) or remove breakpoints and
detach (<code class="docutils literal notranslate"><span class="pre">1</span></code>).</p>
<p>The data in this packet is a single a character, which should be <code class="docutils literal notranslate"><span class="pre">0</span></code> if the
inferior process should be killed, or <code class="docutils literal notranslate"><span class="pre">1</span></code> if the server should remove all
breakpoints and detach from the inferior.</p>
<p><strong>Priority To Implement:</strong> Low. Only required if the target wants to keep the
inferior process alive when the communication channel goes down.</p>
</section>
<section id="qsetdisableaslr-bool">
<h2>QSetDisableASLR:&lt;bool&gt;<a class="headerlink" href="#qsetdisableaslr-bool" title="Link to this heading">#</a></h2>
<p>Enable or disable ASLR on the next ‚ÄúA‚Äù packet.</p>
<p>Or control if ASLR is enabled/disabled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">QSetDisableASLR</span><span class="p">:</span><span class="mi">1</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span>

<span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">QSetDisableASLR</span><span class="p">:</span><span class="mi">0</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span>
</pre></div>
</div>
<p>This packet must be sent  <em>prior</em> to sending a ‚ÄúA‚Äù packet.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed if the remote target wants to launch
a target after making a connection to a GDB server that isn‚Äôt already connected to
an inferior process and if the target supports disabling ASLR
(Address space layout randomization).</p>
</section>
<section id="qsetstdin-ascii-hex-path-qsetstdout-ascii-hex-path-qsetstderr-ascii-hex-path">
<h2>QSetSTDIN:&lt;ascii-hex-path&gt; / QSetSTDOUT:&lt;ascii-hex-path&gt; / QSetSTDERR:&lt;ascii-hex-path&gt;<a class="headerlink" href="#qsetstdin-ascii-hex-path-qsetstdout-ascii-hex-path-qsetstderr-ascii-hex-path" title="Link to this heading">#</a></h2>
<p>Setup where STDIN, STDOUT, and STDERR go prior to sending an ‚ÄúA‚Äù
packet.</p>
<p>When launching a program through the GDB remote protocol with the ‚ÄúA‚Äù packet,
you might also want to specify where stdin/out/err go:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QSetSTDIN</span><span class="p">:</span><span class="o">&lt;</span><span class="n">ascii</span><span class="o">-</span><span class="nb">hex</span><span class="o">-</span><span class="n">path</span><span class="o">&gt;</span>
<span class="n">QSetSTDOUT</span><span class="p">:</span><span class="o">&lt;</span><span class="n">ascii</span><span class="o">-</span><span class="nb">hex</span><span class="o">-</span><span class="n">path</span><span class="o">&gt;</span>
<span class="n">QSetSTDERR</span><span class="p">:</span><span class="o">&lt;</span><span class="n">ascii</span><span class="o">-</span><span class="nb">hex</span><span class="o">-</span><span class="n">path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>These packets must be sent  <em>prior</em> to sending a ‚ÄúA‚Äù packet.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed if the remote target wants to launch
a target after making a connection to a GDB server that isn‚Äôt already connected to
an inferior process.</p>
</section>
<section id="qsetworkingdir-ascii-hex-path">
<h2>QSetWorkingDir:&lt;ascii-hex-path&gt;<a class="headerlink" href="#qsetworkingdir-ascii-hex-path" title="Link to this heading">#</a></h2>
<p>Set the working directory prior to sending an ‚ÄúA‚Äù packet.</p>
<p>Or specify the working directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QSetWorkingDir</span><span class="p">:</span><span class="o">&lt;</span><span class="n">ascii</span><span class="o">-</span><span class="nb">hex</span><span class="o">-</span><span class="n">path</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This packet must be sent  <em>prior</em> to sending a ‚ÄúA‚Äù packet.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed if the remote target wants to launch
a target after making a connection to a GDB server that isn‚Äôt already connected to
an inferior process.</p>
</section>
<section id="qstartnoackmode">
<h2>QStartNoAckMode<a class="headerlink" href="#qstartnoackmode" title="Link to this heading">#</a></h2>
<p>Try to enable no ACK mode to skip sending ACKs and NACKs.</p>
<p>Having to send an ACK/NACK after every packet slows things down a bit, so we
have a way to disable ACK packets to minimize the traffic for reliable
communication interfaces (like sockets). Below GDB or LLDB will send this
packet to try and disable ACKs. All lines that start with ‚Äúsend packet: ‚Äú are
from GDB/LLDB, and all lines that start with ‚Äúread packet: ‚Äú are from the GDB
remote server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $QStartNoAckMode#b0
read packet: +
read packet: $OK#9a
send packet: +
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> High. Any GDB remote server that can implement this
should if the connection is reliable. This improves packet throughput and increases
the performance of the connection.</p>
</section>
<section id="qsupported">
<h2>QSupported<a class="headerlink" href="#qsupported" title="Link to this heading">#</a></h2>
<p>Query the GDB remote server for features it supports</p>
<p>QSupported is a standard GDB Remote Serial Protocol packet, but
there are several additions to the response that lldb can parse.
They are not all listed here.</p>
<p>An example exchange:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">qSupported</span><span class="p">:</span><span class="n">xmlRegisters</span><span class="o">=</span><span class="n">i386</span><span class="p">,</span><span class="n">arm</span><span class="p">,</span><span class="n">mips</span><span class="p">,</span><span class="n">arc</span><span class="p">;</span><span class="n">multiprocess</span><span class="o">+</span><span class="p">;</span><span class="n">fork</span><span class="o">-</span><span class="n">events</span><span class="o">+</span><span class="p">;</span><span class="n">vfork</span><span class="o">-</span><span class="n">events</span><span class="o">+</span>

<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">qXfer</span><span class="p">:</span><span class="n">features</span><span class="p">:</span><span class="n">read</span><span class="o">+</span><span class="p">;</span><span class="n">PacketSize</span><span class="o">=</span><span class="mi">20000</span><span class="p">;</span><span class="n">qEcho</span><span class="o">+</span><span class="p">;</span><span class="n">native</span><span class="o">-</span><span class="n">signals</span><span class="o">+</span><span class="p">;</span><span class="n">SupportedCompressions</span><span class="o">=</span><span class="n">lzfse</span><span class="p">,</span><span class="n">zlib</span><span class="o">-</span><span class="n">deflate</span><span class="p">,</span><span class="n">lz4</span><span class="p">,</span><span class="n">lzma</span><span class="p">;</span><span class="n">SupportedWatchpointTypes</span><span class="o">=</span><span class="n">aarch64</span><span class="o">-</span><span class="n">mask</span><span class="p">,</span><span class="n">aarch64</span><span class="o">-</span><span class="n">bas</span><span class="p">;</span>
</pre></div>
</div>
<p>In the example above, three lldb extensions are shown:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">PacketSize=20000</span></code></p>
<ul class="simple">
<li><p>The base 16 maximum packet size that the stub can handle.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">SupportedCompressions=&lt;item,item,...&gt;</span></code></p>
<ul class="simple">
<li><p>A list of compression types that the stub can use to compress packets
when the QEnableCompression packet is used to request one of them.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">SupportedWatchpointTypes=&lt;item,item,...&gt;</span></code></p>
<ul>
<li><p>A list of watchpoint types that this stub can manage. Currently defined
names are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x86_64</span></code> - 64-bit x86-64 watchpoints (1, 2, 4, 8 byte watchpoints
aligned to those amounts)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aarch64-bas</span></code>  AArch64 Byte Address Select watchpoints
(any number of contiguous bytes within a doubleword)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">aarch64-mask</span></code> AArch64 MASK watchpoints
(any power-of-2 region of memory from 8 to 2GB, aligned)</p></li>
</ul>
<p>If nothing is specified, lldb will default to sending power-of-2
watchpoints, up to a pointer size, <code class="docutils literal notranslate"><span class="pre">sizeof(void*)</span></code>, a reasonable
baseline assumption.</p>
</li>
</ul>
</li>
</ul>
<p><strong>Priority To Implement:</strong> Optional</p>
</section>
<section id="qthreadsuffixsupported">
<h2>QThreadSuffixSupported<a class="headerlink" href="#qthreadsuffixsupported" title="Link to this heading">#</a></h2>
<p>Try to enable thread suffix support for the <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">G</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code>, and <code class="docutils literal notranslate"><span class="pre">P</span></code> packets.</p>
<p>When reading thread registers, you currently need to set the current
thread, then read the registers. This is kind of cumbersome, so we added the
ability to query if the remote GDB server supports adding a <code class="docutils literal notranslate"><span class="pre">thread:&lt;tid&gt;;</span></code>
suffix to all packets that request information for a thread. To test if the
remote GDB server supports this feature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $QThreadSuffixSupported#00
read packet: OK
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">OK</span></code> is returned, then the <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">G</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">P</span></code> packets can accept a
thread suffix. So to send a <code class="docutils literal notranslate"><span class="pre">g</span></code> packet (read all register values):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $g;thread:&lt;tid&gt;;#00
read packet: ....

send packet: $G;thread:&lt;tid&gt;;#00
read packet: ....

send packet: $p1a;thread:&lt;tid&gt;;#00
read packet: ....

send packet: $P1a=1234abcd;thread:&lt;tid&gt;;#00
read packet: ....
</pre></div>
</div>
<p>otherwise, without this you would need to always send two packets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $Hg&lt;tid&gt;#00
read packet: ....
send packet: $g#00
read packet: ....
</pre></div>
</div>
<p>We also added support for allocating and deallocating memory. We use this to
allocate memory so we can run JITed code.</p>
<p><strong>Priority To Implement:</strong> High</p>
<p>Adding a thread suffix allows us to read and write registers
more efficiently and stops us from having to select a thread with
one packet and then read registers with a second packet. It also
makes sure that no errors can occur where the debugger thinks it
already has a thread selected (see the <code class="docutils literal notranslate"><span class="pre">Hg</span></code> packet from the standard
GDB remote protocol documentation) yet the remote GDB server actually
has another thread selected.</p>
</section>
<section id="qattachorwaitsupported">
<h2>qAttachOrWaitSupported<a class="headerlink" href="#qattachorwaitsupported" title="Link to this heading">#</a></h2>
<p>This is a binary ‚Äúis it supported‚Äù query. Return OK if you support
<code class="docutils literal notranslate"><span class="pre">vAttachOrWait</span></code>.</p>
<p><strong>Priority To Implement:</strong> Low. This is required if you support <code class="docutils literal notranslate"><span class="pre">vAttachOrWait</span></code>,
otherwise no support is needed since the standard ‚ÄúI don‚Äôt recognize this packet‚Äù
response will do the right thing.</p>
</section>
<section id="qfileloadaddress-file-path">
<h2>qFileLoadAddress:&lt;file_path&gt;<a class="headerlink" href="#qfileloadaddress-file-path" title="Link to this heading">#</a></h2>
<p>Get the load address of a memory mapped file.
The load address is defined as the address of the first memory
region what contains data mapped from the specified file.</p>
<p>The response is either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;unsigned-hex64&gt;</span></code> - Load address of the file in big endian encoding</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E01</span></code> - the requested file isn‚Äôt loaded</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXX</span></code> - for any other errors</p></li>
</ul>
<p><strong>Priority To Implement:</strong> Low, required if dynamic linker don‚Äôt fill in the load
address of some object file in the rendezvous data structure.</p>
</section>
<section id="qfprocessinfo-qsprocessinfo-platform-extension">
<h2>qfProcessInfo / qsProcessInfo (Platform Extension)<a class="headerlink" href="#qfprocessinfo-qsprocessinfo-platform-extension" title="Link to this heading">#</a></h2>
<p>Get the first process info (<code class="docutils literal notranslate"><span class="pre">qfProcessInfo</span></code>) or subsequent process
info (<code class="docutils literal notranslate"><span class="pre">qsProcessInfo</span></code>) for one or more processes on the remote
platform. The first call gets the first match and subsequent calls
to <code class="docutils literal notranslate"><span class="pre">qsProcessInfo</span></code> gets the subsequent matches. Return an error <code class="docutils literal notranslate"><span class="pre">EXX</span></code>,
where <code class="docutils literal notranslate"><span class="pre">XX</span></code> are two hex digits, when no more matches are available.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">qfProcessInfo</span></code> packet can be followed by a <code class="docutils literal notranslate"><span class="pre">:</span></code> and
some key value pairs. The key value pairs in the command are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - <code class="docutils literal notranslate"><span class="pre">ascii-hex</span></code> -
An ASCII hex string that contains the name of the process that will be matched.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name_match</span></code> - <code class="docutils literal notranslate"><span class="pre">enum</span></code> -
One of:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">equals</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">starts_with</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ends_with</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">contains</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">regex</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">pid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code>- A string value containing the decimal process ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parent_pid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal parent process ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal user ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal group ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">euid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal effective user ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">egid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal effective group ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all_users</span></code> - <code class="docutils literal notranslate"><span class="pre">bool</span></code> -
A boolean value that specifies if processes should
be listed for all users, not just the user that the
platform is running as</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">triple</span></code> - <code class="docutils literal notranslate"><span class="pre">string</span></code> -
An ASCII triple string (<code class="docutils literal notranslate"><span class="pre">x86_64</span></code>, <code class="docutils literal notranslate"><span class="pre">x86_64-apple-macosx</span></code>, <code class="docutils literal notranslate"><span class="pre">armv7-apple-ios</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code> - <code class="docutils literal notranslate"><span class="pre">string</span></code> -
A string value containing the process arguments separated by the character <code class="docutils literal notranslate"><span class="pre">-</span></code>,
where each argument is hex-encoded. It includes <code class="docutils literal notranslate"><span class="pre">argv[0]</span></code>.</p></li>
</ul>
<p>The response consists of key/value pairs where the key is separated from the
values with colons and each pair is terminated with a semi colon. For a list
of the key/value pairs in the response see the <code class="docutils literal notranslate"><span class="pre">qProcessInfoPID</span></code> packet
documentation.</p>
<p>Sample packet/response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qfProcessInfo#00
read packet: $pid:60001;ppid:59948;uid:7746;gid:11;euid:7746;egid:11;name:6c6c6462;triple:x86_64-apple-macosx;#00
send packet: $qsProcessInfo#00
read packet: $pid:59992;ppid:192;uid:7746;gid:11;euid:7746;egid:11;name:6d64776f726b6572;triple:x86_64-apple-macosx;#00
send packet: $qsProcessInfo#00
read packet: $E04#00
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> Required</p>
</section>
<section id="qgdbserverversion">
<h2>qGDBServerVersion<a class="headerlink" href="#qgdbserverversion" title="Link to this heading">#</a></h2>
<p>Get version information about this implementation of the gdb-remote
protocol.</p>
<p>The goal of this packet is to provide enough information about an
implementation of the gdb-remote-protocol server that lldb can
work around implementation problems that are discovered after the
version has been released/deployed.  The name and version number
should be sufficiently unique that lldb can unambiguously identify
the origin of the program (for instance, debugserver from lldb) and
the version/submission number/patch level of the program - whatever
is appropriate for your server implementation.</p>
<p>The packet follows the key-value pair model, semicolon separated.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qGDBServerVersion#00
read packet: $name:debugserver;version:310.2;#00
</pre></div>
</div>
<p>Other clients may find other key-value pairs to be useful for identifying
a gdb stub.  Patch level, release name, build number may all be keys that
better describe your implementation‚Äôs version.</p>
<p>Suggested key names:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: the name of your remote server - ‚Äúdebugserver‚Äù is the lldb standard
implementation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">version</span></code>: identifies the version number of this server</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">patch_level</span></code>: the patch level of this server</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">release_name</span></code>: the name of this release, if your project uses names</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">build_number</span></code>: if you use a build system with increasing build numbers,
this may be the right key name for your server</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">major_version</span></code>: major version number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minor_version</span></code>: minor version number</p></li>
</ul>
<p><strong>Priority To Implement:</strong> High. This packet is usually very easy to implement
and can help LLDB to work around bugs in a server‚Äôs implementation when they
are found.</p>
</section>
<section id="qgetworkingdir">
<h2>qGetWorkingDir<a class="headerlink" href="#qgetworkingdir" title="Link to this heading">#</a></h2>
<p>Get the current working directory of the platform stub in
ASCII hex encoding.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">qGetWorkingDir</span>
<span class="n">send</span><span class="p">:</span>    <span class="mi">2</span><span class="n">f4170706c65496e7465726e616c2f6c6c64622f73657474696e67732f342f5465737453657474696e67732e746573745f646973617373656d626c65725f73657474696e6773</span>
</pre></div>
</div>
</section>
<section id="qhostinfo">
<h2>qHostInfo<a class="headerlink" href="#qhostinfo" title="Link to this heading">#</a></h2>
<p>Get information about the host we are remotely connected to.</p>
<p>LLDB supports a host info call that gets all sorts of details of the system
that is being debugged:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qHostInfo#00
read packet: $cputype:16777223;cpusubtype:3;ostype:darwin;vendor:apple;endian:little;ptrsize:8;#00
</pre></div>
</div>
<p>Key value pairs are one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cputype</span></code>: is a number that is the mach-o CPU type that is being debugged (base 10)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cpusubtype</span></code>: is a number that is the mach-o CPU subtype type that is being debugged (base 10)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">triple</span></code>: a string for the target triple (x86_64-apple-macosx) that can be used to specify arch + vendor + os in one entry</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vendor</span></code>: a string for the vendor (apple), not needed if ‚Äútriple‚Äù is specified</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ostype</span></code>: a string for the OS being debugged (macosx, linux, freebsd, ios, watchos), not needed if ‚Äútriple‚Äù is specified</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endian</span></code>: is one of ‚Äúlittle‚Äù, ‚Äúbig‚Äù, or ‚Äúpdp‚Äù</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ptrsize</span></code>: an unsigned number that represents how big pointers are in bytes on the debug target</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hostname</span></code>: the hostname of the host that is running the GDB server if available</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">os_build</span></code>: a string for the OS build for the remote host as a string value</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">os_kernel</span></code>: a string describing the kernel version</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">os_version</span></code>: a version string that represents the current OS version (10.8.2)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">watchpoint_exceptions_received</span></code>: one of ‚Äúbefore‚Äù or ‚Äúafter‚Äù to specify if a watchpoint is triggered before or after the pc when it stops</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_packet_timeout</span></code>: an unsigned number that specifies the default timeout in seconds</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distribution_id</span></code>: optional. For linux, specifies distribution id (e.g. ubuntu, fedora, etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">osmajor</span></code>: optional, specifies the major version number of the OS (e.g. for macOS 10.12.2, it would be 10)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">osminor</span></code>: optional, specifies the minor version number of the OS (e.g. for macOS 10.12.2, it would be 12)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ospatch</span></code>: optional, specifies the patch level number of the OS (e.g. for macOS 10.12.2, it would be 2)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vm-page-size</span></code>: optional, specifies the target system VM page size, base 10.
Needed for the ‚Äúdirty-pages:‚Äù list in the qMemoryRegionInfo
packet, where a list of dirty pages is sent from the remote
stub.  This page size tells lldb how large each dirty page is.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">addressing_bits</span></code>: optional, specifies how many bits in addresses are
significant for addressing, base 10.  If bits 38..0
in a 64-bit pointer are significant for addressing,
then the value is 39.  This is needed on e.g. AArch64
v8.3 ABIs that use pointer authentication, so lldb
knows which bits to clear/set to get the actual
addresses.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">low_mem_addressing_bits</span></code>: optional, specifies how many bits in
addresses in low memory are significant for addressing, base 10.
AArch64 can have different page table setups for low and high
memory, and therefore a different number of bits used for addressing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high_mem_addressing_bits</span></code>: optional, specifies how many bits in
addresses in high memory are significant for addressing, base 10.
AArch64 can have different page table setups for low and high
memory, and therefore a different number of bits used for addressing.</p></li>
</ul>
<p><strong>Priority To Implement:</strong> High. This packet is usually very easy to implement
and can help LLDB select the correct plug-ins for the job based on the target
triple information that is supplied.</p>
</section>
<section id="qkillspawnedprocess-platform-extension">
<h2>qKillSpawnedProcess (Platform Extension)<a class="headerlink" href="#qkillspawnedprocess-platform-extension" title="Link to this heading">#</a></h2>
<p>Kill a process running on the target system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">qKillSpawnedProcess</span><span class="p">:</span><span class="mi">1337</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">OK</span>
</pre></div>
</div>
<p>The request packet has the process ID in base 10.</p>
</section>
<section id="qlaunchgdbserver-platform-extension">
<h2>qLaunchGDBServer (Platform Extension)<a class="headerlink" href="#qlaunchgdbserver-platform-extension" title="Link to this heading">#</a></h2>
<p>Have the remote platform launch a GDB server.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">qLaunchGDBServer</span></code> packet must be followed by a <code class="docutils literal notranslate"><span class="pre">:</span></code> and
some key value pairs. The key value pairs in the command are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">port</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> -
A string value containing the decimal port ID or zero if the port should be
bound and returned</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">host</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> -
The host that connections should be limited to when the GDB server is connected to.</p></li>
</ul>
<p>Sample packet/response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qLaunchGDBServer:port:0;host:lldb.apple.com;#00
read packet: $pid:60025;port:50776;#00
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pid</span></code> key/value pair is only specified if the remote platform launched
a separate process for the GDB remote server and can be omitted if no
process was separately launched.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">port</span></code> key/value pair in the response lets clients know what port number
to attach to in case zero was specified as the ‚Äúport‚Äù in the sent command.</p>
<p><strong>Priority To Implement:</strong> Required</p>
</section>
<section id="qlaunchsuccess">
<h2>qLaunchSuccess<a class="headerlink" href="#qlaunchsuccess" title="Link to this heading">#</a></h2>
<p>Check whether launching a process with the <code class="docutils literal notranslate"><span class="pre">A</span></code> packet succeeded.</p>
<p>Returns the status of the last attempt to launch a process.
Either <code class="docutils literal notranslate"><span class="pre">OK</span></code> if no error ocurred, or <code class="docutils literal notranslate"><span class="pre">E</span></code> followed by a string
describing the error.</p>
<p><strong>Priority To Implement:</strong> High, launching processes is a key part of LLDB‚Äôs
platform mode.</p>
</section>
<section id="qmemoryregioninfo-addr">
<h2>qMemoryRegionInfo:&lt;addr&gt;<a class="headerlink" href="#qmemoryregioninfo-addr" title="Link to this heading">#</a></h2>
<p>Get information about the address range that contains <code class="docutils literal notranslate"><span class="pre">&lt;addr&gt;</span></code>.</p>
<p>We added a way to get information for a memory region. The packet is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">qMemoryRegionInfo</span><span class="p">:</span><span class="o">&lt;</span><span class="n">addr</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">&lt;addr&gt;</span></code> is a big endian hex address. The response is returned in a series
of tuples like the data returned in a stop reply packet. The currently valid
tuples to return are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">start:&lt;start-addr&gt;;</span></code> - <code class="docutils literal notranslate"><span class="pre">&lt;start-addr&gt;</span></code> is a big endian hex address that is
the start address of the range that contains <code class="docutils literal notranslate"><span class="pre">&lt;addr&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">size:&lt;size&gt;;</span></code> - <code class="docutils literal notranslate"><span class="pre">&lt;size&gt;</span></code> is a big endian hex byte size of the address
of the range that contains <code class="docutils literal notranslate"><span class="pre">&lt;addr&gt;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">permissions:&lt;permissions&gt;;</span></code> - <code class="docutils literal notranslate"><span class="pre">&lt;permissions&gt;</span></code> is a string that contains one
or more of the characters from <code class="docutils literal notranslate"><span class="pre">rwx</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name:&lt;name&gt;;</span></code> - <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> is a hex encoded string that contains the name of
the memory region mapped at the given address. In case of
regions backed by a file it have to be the absolute path of
the file while for anonymous regions it have to be the name
associated to the region if that is available.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flags:&lt;flags-string&gt;;</span></code> - where <code class="docutils literal notranslate"><span class="pre">&lt;flags-string&gt;</span></code> is a space separated string
of flag names. Currently the only supported flag
is <code class="docutils literal notranslate"><span class="pre">mt</span></code> for AArch64 memory tagging. lldb will
ignore any other flags in this field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type:[&lt;type&gt;][,&lt;type&gt;];</span></code> - memory types that apply to this region, e.g.
<code class="docutils literal notranslate"><span class="pre">stack</span></code> for stack memory.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error:&lt;ascii-byte-error-string&gt;;</span></code> - where <code class="docutils literal notranslate"><span class="pre">&lt;ascii-byte-error-string&gt;</span></code> is
a hex encoded string value that
contains an error string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dirty-pages:[&lt;hexaddr&gt;][,&lt;hexaddr];</span></code> -
A list of memory pages within this
region that are ‚Äúdirty‚Äù ‚Äì they have been modified.
Page addresses are in base 16. The size of a page can
be found from the <code class="docutils literal notranslate"><span class="pre">qHostInfo</span></code>‚Äôs <code class="docutils literal notranslate"><span class="pre">page-size</span></code> key-value.</p>
<p>If the stub supports identifying dirty pages within a
memory region, this key should always be present for all
<code class="docutils literal notranslate"><span class="pre">qMemoryRegionInfo</span></code> replies.  This key with no pages
listed (<code class="docutils literal notranslate"><span class="pre">dirty-pages:;</span></code>) indicates no dirty pages in
this memory region.  The <em>absence</em> of this key means
that this stub cannot determine dirty pages.</p>
</li>
</ul>
<p>If the address requested is not in a mapped region (e.g. we‚Äôve jumped through
a NULL pointer and are at 0x0) currently lldb expects to get back the size
of the unmapped region ‚Äì that is, the distance to the next valid region.
For instance, with a macOS process which has nothing mapped in the first
4GB of its address space, if we‚Äôre asking about address 0x2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">qMemoryRegionInfo</span><span class="p">:</span><span class="mi">2</span>
  <span class="n">start</span><span class="p">:</span><span class="mi">2</span><span class="p">;</span><span class="n">size</span><span class="p">:</span><span class="n">fffffffe</span><span class="p">;</span>
</pre></div>
</div>
<p>The lack of <code class="docutils literal notranslate"><span class="pre">permissions:</span></code> indicates that none of read/write/execute are valid
for this region.</p>
<p>The stub must include <code class="docutils literal notranslate"><span class="pre">permissions:</span></code> key-value on all memory ranges
that are valid to access in the inferior process ‚Äì the lack of
<code class="docutils literal notranslate"><span class="pre">permissions:</span></code> means that this is an inaccessible (no page table
entries exist, in a system using VM) memory range.  If a stub cannot
determine actual permissions, return <code class="docutils literal notranslate"><span class="pre">rwx</span></code>.</p>
<p><strong>Priority To Implement:</strong> Medium</p>
<p>This is nice to have, but it isn‚Äôt necessary. It helps LLDB
do stack unwinding when we branch into memory that isn‚Äôt executable.
If we can detect that the code we are stopped in isn‚Äôt executable,
then we can recover registers for stack frames above the current
frame. Otherwise we must assume we are in some JIT‚Äôed code (not JIT
code that LLDB has made) and assume that no registers are available
in higher stack frames.</p>
</section>
<section id="qmoduleinfo-module-path-arch-triple">
<h2>qModuleInfo:&lt;module_path&gt;;&lt;arch triple&gt;<a class="headerlink" href="#qmoduleinfo-module-path-arch-triple" title="Link to this heading">#</a></h2>
<p>Get information for a module by given module path and architecture.</p>
<p>The response is either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(uuid|md5):...;triple:...;file_offset:...;file_size...;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXX</span></code> - for any errors</p></li>
</ul>
<p><strong>Priority To Implement:</strong> Optional, required if dynamic loader cannot fetch
module‚Äôs information like UUID directly from inferior‚Äôs memory.</p>
</section>
<section id="qpathcomplete-platform-extension">
<h2>qPathComplete (Platform Extension)<a class="headerlink" href="#qpathcomplete-platform-extension" title="Link to this heading">#</a></h2>
<p>Get a list of matched disk files/directories by passing a boolean flag
and a partial path.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">qPathComplete</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="n">d61696e</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">M6d61696e2e637070</span>
<span class="n">receive</span><span class="p">:</span> <span class="n">qPathComplete</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">746573</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">M746573742f</span><span class="p">,</span><span class="mi">74657374732</span><span class="n">f</span>
</pre></div>
</div>
<p>If the first argument is zero, the result should contain all
files (including directories) starting with the given path. If the
argument is one, the result should contain only directories.</p>
<p>The result should be a comma-separated list of hex-encoded paths.
Paths denoting a directory should end with a directory separator (<code class="docutils literal notranslate"><span class="pre">/</span></code> or <code class="docutils literal notranslate"><span class="pre">\</span></code>.</p>
</section>
<section id="qplatform-mkdir">
<h2>qPlatform_mkdir<a class="headerlink" href="#qplatform-mkdir" title="Link to this heading">#</a></h2>
<p>Creates a new directory on the connected remote machine.</p>
<p>Request: <code class="docutils literal notranslate"><span class="pre">qPlatform_mkdir:&lt;hex-file-mode&gt;,&lt;ascii-hex-path&gt;</span></code></p>
<p>The request packet has the fields:</p>
<ol class="arabic simple">
<li><p>mode bits in base 16</p></li>
<li><p>file path in ascii-hex encoding</p></li>
</ol>
<p>Reply:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F&lt;mkdir-return-code&gt;</span></code>
(mkdir called successfully and returned with the given return code)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Exx</span></code> (An error occurred)</p></li>
</ul>
<p><strong>Priority To Implement:</strong> Low</p>
</section>
<section id="qplatform-shell">
<h2>qPlatform_shell<a class="headerlink" href="#qplatform-shell" title="Link to this heading">#</a></h2>
<p>Run a command in a shell on the connected remote machine.</p>
<p>The request consists of the command to be executed encoded in ASCII characters
converted into hex bytes.</p>
<p>The response to this packet consists of the letter F followed by the return code,
followed by the signal number (or 0 if no signal was delivered), and escaped bytes
of captured program output.</p>
<p>Below is an example communication from a client sending an ‚Äúls -la‚Äù command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qPlatform_shell:6c73202d6c61,00000002#ec
read packet: $F,00000000,00000000,total 4736
drwxrwxr-x 16 username groupname    4096 Aug 15 21:36 .
drwxr-xr-x 17 username groupname    4096 Aug 10 16:39 ..
-rw-rw-r--  1 username groupname   73875 Aug 12 16:46 notes.txt
drwxrwxr-x  5 username groupname    4096 Aug 15 21:36 source.cpp
-rw-r--r--  1 username groupname    2792 Aug 12 16:46 a.out
-rw-r--r--  1 username groupname    3190 Aug 12 16:46 Makefile
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> High</p>
</section>
<section id="qprocessinfo">
<h2>qProcessInfo<a class="headerlink" href="#qprocessinfo" title="Link to this heading">#</a></h2>
<p>Get information about the process we are currently debugging.</p>
<p><strong>Priority To Implement:</strong> Medium</p>
<p>On systems which can launch multiple different architecture processes,
the qHostInfo may not disambiguate sufficiently to know what kind of
process is being debugged.</p>
<p>For example on a 64-bit x86 Mac system both 32-bit and 64-bit user processes are possible,
and with Mach-O universal files, the executable file may contain both 32- and
64-bit slices so it may be impossible to know until you‚Äôre attached to a real
process to know what you‚Äôre working with.</p>
<p>All numeric fields return base 16 numbers without any ‚Äú0x‚Äù prefix.</p>
<p>An i386 process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qProcessInfo#00
read packet: $pid:42a8;parent-pid:42bf;real-uid:ecf;real-gid:b;effective-uid:ecf;effective-gid:b;cputype:7;cpusubtype:3;ostype:macosx;vendor:apple;endian:little;ptrsize:4;#00
</pre></div>
</div>
<p>An x86_64 process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qProcessInfo#00
read packet: $pid:d22c;parent-pid:d34d;real-uid:ecf;real-gid:b;effective-uid:ecf;effective-gid:b;cputype:1000007;cpusubtype:3;ostype:macosx;vendor:apple;endian:little;ptrsize:8;#00
</pre></div>
</div>
<p>Key value pairs include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pid</span></code>: the process id</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parent-pid</span></code>: the process of the parent process (often debugserver will become the parent when attaching)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">real-uid</span></code>: the real user id of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">real-gid</span></code>: the real group id of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">effective-uid</span></code>: the effective user id of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">effective-gid</span></code>: the effective group id of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cputype</span></code>: the Mach-O CPU type of the process  (base 16)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cpusubtype</span></code>: the Mach-O CPU subtype of the process  (base 16)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ostype</span></code>: is a string the represents the OS being debugged (darwin, linux, freebsd)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vendor</span></code>: is a string that represents the vendor (apple)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">endian</span></code>: is one of ‚Äúlittle‚Äù, ‚Äúbig‚Äù, or ‚Äúpdp‚Äù</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ptrsize</span></code>: is a number that represents how big pointers are in bytes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">main-binary-uuid</span></code>: is the UUID of a firmware type binary that the gdb stub knows about</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">main-binary-address</span></code>: is the load address of the firmware type binary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">main-binary-slide</span></code>: is the slide of the firmware type binary, if address isn‚Äôt known</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">binary-addresses</span></code>: A comma-separated list of binary load addresses base 16.
lldb will parse the binaries in memory to get UUIDs, then
try to find the binaries &amp; debug info by UUID.  Intended for
use with a small number of firmware type binaries where the
search for binary/debug info may be expensive.</p></li>
</ul>
</section>
<section id="qprocessinfopid-pid-platform-extension">
<h2>qProcessInfoPID:PID (Platform Extension)<a class="headerlink" href="#qprocessinfopid-pid-platform-extension" title="Link to this heading">#</a></h2>
<p>Have the remote platform get detailed information on a process by
ID. PID is specified as a decimal integer.</p>
<p>The response consists of key/value pairs where the key is separated from the
values with colons and each pair is terminated with a semi colon.</p>
<p>The key value pairs in the response are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - Process ID as a decimal integer string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ppid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - Parent process ID as a decimal integer string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">uid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal user ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal group ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">euid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal effective user ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">egid</span></code> - <code class="docutils literal notranslate"><span class="pre">integer</span></code> - A string value containing the decimal effective group ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - <code class="docutils literal notranslate"><span class="pre">ascii-hex</span></code> - An ASCII hex string that contains the name of the process</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">triple</span></code> - <code class="docutils literal notranslate"><span class="pre">string</span></code> - A target triple (<code class="docutils literal notranslate"><span class="pre">x86_64-apple-macosx</span></code>, <code class="docutils literal notranslate"><span class="pre">armv7-apple-ios</span></code>)</p></li>
</ul>
<p>Sample packet/response:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qProcessInfoPID:60050#00
read packet: $pid:60050;ppid:59948;uid:7746;gid:11;euid:7746;egid:11;name:6c6c6462;triple:x86_64-apple-macosx;#00
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> Optional</p>
</section>
<section id="qquerygdbserver">
<h2>qQueryGDBServer<a class="headerlink" href="#qquerygdbserver" title="Link to this heading">#</a></h2>
<p>Ask the platform for the list of gdbservers we have to connect</p>
<p>If the remote platform automatically started one or more gdbserver instance (without
lldb asking it) then it have to return the list of port number or socket name for
each of them what can be used by lldb to connect to those instances.</p>
<p>The data in this packet is a JSON array of JSON objects with the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">port</span></code>: <code class="docutils literal notranslate"><span class="pre">&lt;the</span> <span class="pre">port</span> <span class="pre">number</span> <span class="pre">to</span> <span class="pre">connect&gt;</span></code> (optional)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">socket_name</span></code>: <code class="docutils literal notranslate"><span class="pre">&lt;the</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">socket</span> <span class="pre">to</span> <span class="pre">connect&gt;</span></code> (optional)</p></li>
</ul>
<p>Example packet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span> <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">1234</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="mi">5432</span> <span class="p">},</span>
    <span class="p">{</span> <span class="s2">&quot;socket_name&quot;</span><span class="p">:</span> <span class="s2">&quot;foo&quot;</span> <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> Low</p>
<p>The packet is required to support connecting to gdbserver started
by the platform instance automatically.</p>
</section>
<section id="qregisterinfo-hex-reg-id">
<h2>qRegisterInfo&lt;hex-reg-id&gt;<a class="headerlink" href="#qregisterinfo-hex-reg-id" title="Link to this heading">#</a></h2>
<p>Discover register information from the remote GDB server.</p>
<p>With LLDB, for register information, remote GDB servers can add
support for the ‚ÄúqRegisterInfoN‚Äù packet where ‚ÄúN‚Äù is a zero based
base 16 register number that must start at zero and increase by one
for each register that is supported.  The response is done in typical
GDB remote fashion where a series of ‚ÄúKEY:VALUE;‚Äù pairs are returned.
An example for the x86_64 registers is included below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qRegisterInfo0#00
read packet: $name:rax;bitsize:64;offset:0;encoding:uint;format:hex;set:General Purpose Registers;gcc:0;dwarf:0;#00
send packet: $qRegisterInfo1#00
read packet: $name:rbx;bitsize:64;offset:8;encoding:uint;format:hex;set:General Purpose Registers;gcc:3;dwarf:3;#00
send packet: $qRegisterInfo2#00
read packet: $name:rcx;bitsize:64;offset:16;encoding:uint;format:hex;set:General Purpose Registers;gcc:2;dwarf:2;#00
send packet: $qRegisterInfo3#00
read packet: $name:rdx;bitsize:64;offset:24;encoding:uint;format:hex;set:General Purpose Registers;gcc:1;dwarf:1;#00
send packet: $qRegisterInfo4#00
read packet: $name:rdi;bitsize:64;offset:32;encoding:uint;format:hex;set:General Purpose Registers;gcc:5;dwarf:5;#00
send packet: $qRegisterInfo5#00
read packet: $name:rsi;bitsize:64;offset:40;encoding:uint;format:hex;set:General Purpose Registers;gcc:4;dwarf:4;#00
send packet: $qRegisterInfo6#00
read packet: $name:rbp;alt-name:fp;bitsize:64;offset:48;encoding:uint;format:hex;set:General Purpose Registers;gcc:6;dwarf:6;generic:fp;#00
send packet: $qRegisterInfo7#00
read packet: $name:rsp;alt-name:sp;bitsize:64;offset:56;encoding:uint;format:hex;set:General Purpose Registers;gcc:7;dwarf:7;generic:sp;#00
send packet: $qRegisterInfo8#00
read packet: $name:r8;bitsize:64;offset:64;encoding:uint;format:hex;set:General Purpose Registers;gcc:8;dwarf:8;#00
send packet: $qRegisterInfo9#00
read packet: $name:r9;bitsize:64;offset:72;encoding:uint;format:hex;set:General Purpose Registers;gcc:9;dwarf:9;#00
send packet: $qRegisterInfoa#00
read packet: $name:r10;bitsize:64;offset:80;encoding:uint;format:hex;set:General Purpose Registers;gcc:10;dwarf:10;#00
send packet: $qRegisterInfob#00
read packet: $name:r11;bitsize:64;offset:88;encoding:uint;format:hex;set:General Purpose Registers;gcc:11;dwarf:11;#00
send packet: $qRegisterInfoc#00
read packet: $name:r12;bitsize:64;offset:96;encoding:uint;format:hex;set:General Purpose Registers;gcc:12;dwarf:12;#00
send packet: $qRegisterInfod#00
read packet: $name:r13;bitsize:64;offset:104;encoding:uint;format:hex;set:General Purpose Registers;gcc:13;dwarf:13;#00
send packet: $qRegisterInfoe#00
read packet: $name:r14;bitsize:64;offset:112;encoding:uint;format:hex;set:General Purpose Registers;gcc:14;dwarf:14;#00
send packet: $qRegisterInfof#00
read packet: $name:r15;bitsize:64;offset:120;encoding:uint;format:hex;set:General Purpose Registers;gcc:15;dwarf:15;#00
send packet: $qRegisterInfo10#00
read packet: $name:rip;alt-name:pc;bitsize:64;offset:128;encoding:uint;format:hex;set:General Purpose Registers;gcc:16;dwarf:16;generic:pc;#00
send packet: $qRegisterInfo11#00
read packet: $name:rflags;alt-name:flags;bitsize:64;offset:136;encoding:uint;format:hex;set:General Purpose Registers;#00
send packet: $qRegisterInfo12#00
read packet: $name:cs;bitsize:64;offset:144;encoding:uint;format:hex;set:General Purpose Registers;#00
send packet: $qRegisterInfo13#00
read packet: $name:fs;bitsize:64;offset:152;encoding:uint;format:hex;set:General Purpose Registers;#00
send packet: $qRegisterInfo14#00
read packet: $name:gs;bitsize:64;offset:160;encoding:uint;format:hex;set:General Purpose Registers;#00
send packet: $qRegisterInfo15#00
read packet: $name:fctrl;bitsize:16;offset:176;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo16#00
read packet: $name:fstat;bitsize:16;offset:178;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo17#00
read packet: $name:ftag;bitsize:8;offset:180;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo18#00
read packet: $name:fop;bitsize:16;offset:182;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo19#00
read packet: $name:fioff;bitsize:32;offset:184;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo1a#00
read packet: $name:fiseg;bitsize:16;offset:188;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo1b#00
read packet: $name:fooff;bitsize:32;offset:192;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo1c#00
read packet: $name:foseg;bitsize:16;offset:196;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo1d#00
read packet: $name:mxcsr;bitsize:32;offset:200;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo1e#00
read packet: $name:mxcsrmask;bitsize:32;offset:204;encoding:uint;format:hex;set:Floating Point Registers;#00
send packet: $qRegisterInfo1f#00
read packet: $name:stmm0;bitsize:80;offset:208;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:33;dwarf:33;#00
send packet: $qRegisterInfo20#00
read packet: $name:stmm1;bitsize:80;offset:224;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:34;dwarf:34;#00
send packet: $qRegisterInfo21#00
read packet: $name:stmm2;bitsize:80;offset:240;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:35;dwarf:35;#00
send packet: $qRegisterInfo22#00
read packet: $name:stmm3;bitsize:80;offset:256;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:36;dwarf:36;#00
send packet: $qRegisterInfo23#00
read packet: $name:stmm4;bitsize:80;offset:272;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:37;dwarf:37;#00
send packet: $qRegisterInfo24#00
read packet: $name:stmm5;bitsize:80;offset:288;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:38;dwarf:38;#00
send packet: $qRegisterInfo25#00
read packet: $name:stmm6;bitsize:80;offset:304;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:39;dwarf:39;#00
send packet: $qRegisterInfo26#00
read packet: $name:stmm7;bitsize:80;offset:320;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:40;dwarf:40;#00
send packet: $qRegisterInfo27#00
read packet: $name:xmm0;bitsize:128;offset:336;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:17;dwarf:17;#00
send packet: $qRegisterInfo28#00
read packet: $name:xmm1;bitsize:128;offset:352;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:18;dwarf:18;#00
send packet: $qRegisterInfo29#00
read packet: $name:xmm2;bitsize:128;offset:368;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:19;dwarf:19;#00
send packet: $qRegisterInfo2a#00
read packet: $name:xmm3;bitsize:128;offset:384;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:20;dwarf:20;#00
send packet: $qRegisterInfo2b#00
read packet: $name:xmm4;bitsize:128;offset:400;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:21;dwarf:21;#00
send packet: $qRegisterInfo2c#00
read packet: $name:xmm5;bitsize:128;offset:416;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:22;dwarf:22;#00
send packet: $qRegisterInfo2d#00
read packet: $name:xmm6;bitsize:128;offset:432;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:23;dwarf:23;#00
send packet: $qRegisterInfo2e#00
read packet: $name:xmm7;bitsize:128;offset:448;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:24;dwarf:24;#00
send packet: $qRegisterInfo2f#00
read packet: $name:xmm8;bitsize:128;offset:464;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:25;dwarf:25;#00
send packet: $qRegisterInfo30#00
read packet: $name:xmm9;bitsize:128;offset:480;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:26;dwarf:26;#00
send packet: $qRegisterInfo31#00
read packet: $name:xmm10;bitsize:128;offset:496;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:27;dwarf:27;#00
send packet: $qRegisterInfo32#00
read packet: $name:xmm11;bitsize:128;offset:512;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:28;dwarf:28;#00
send packet: $qRegisterInfo33#00
read packet: $name:xmm12;bitsize:128;offset:528;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:29;dwarf:29;#00
send packet: $qRegisterInfo34#00
read packet: $name:xmm13;bitsize:128;offset:544;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:30;dwarf:30;#00
send packet: $qRegisterInfo35#00
read packet: $name:xmm14;bitsize:128;offset:560;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:31;dwarf:31;#00
send packet: $qRegisterInfo36#00
read packet: $name:xmm15;bitsize:128;offset:576;encoding:vector;format:vector-uint8;set:Floating Point Registers;gcc:32;dwarf:32;#00
send packet: $qRegisterInfo37#00
read packet: $name:trapno;bitsize:32;offset:696;encoding:uint;format:hex;set:Exception State Registers;#00
send packet: $qRegisterInfo38#00
read packet: $name:err;bitsize:32;offset:700;encoding:uint;format:hex;set:Exception State Registers;#00
send packet: $qRegisterInfo39#00
read packet: $name:faultvaddr;bitsize:64;offset:704;encoding:uint;format:hex;set:Exception State Registers;#00
send packet: $qRegisterInfo3a#00
read packet: $E45#00
</pre></div>
</div>
<p>As we see above we keep making subsequent calls to the remote server to
discover all registers by increasing the number appended to <code class="docutils literal notranslate"><span class="pre">qRegisterInfo</span></code> and
we get a response back that is a series of <code class="docutils literal notranslate"><span class="pre">key=value;</span></code> strings.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">offset:</span></code> fields should not leave a gap anywhere in the g/G packet ‚Äì the
register values should be appended one after another.  For instance, if the
register context for a thread looks like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">struct</span> <span class="n">rctx</span> <span class="p">{</span>
    <span class="n">uint32_t</span> <span class="n">gpr1</span><span class="p">;</span>  <span class="o">//</span> <span class="n">offset</span> <span class="mi">0</span>
    <span class="n">uint32_t</span> <span class="n">gpr2</span><span class="p">;</span>  <span class="o">//</span> <span class="n">offset</span> <span class="mi">4</span>
    <span class="n">uint32_t</span> <span class="n">gpr3</span><span class="p">;</span>  <span class="o">//</span> <span class="n">offset</span> <span class="mi">8</span>
    <span class="n">uint64_t</span> <span class="n">fp1</span><span class="p">;</span>   <span class="o">//</span> <span class="n">offset</span> <span class="mi">16</span>
<span class="p">};</span>
</pre></div>
</div>
<p>You may end up with a 4-byte gap between gpr3 and fp1 on architectures
that align values like this.  The correct offset: value for fp1 is 12 -
in the g/G packet fp1 will immediately follow gpr3, even though the
in-memory thread structure has an empty 4 bytes for alignment between
these two registers.</p>
<p>The keys and values are detailed below:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> -
The primary register name as a string (‚Äúrbp‚Äù for example)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alt-name</span></code> -
An alternate name for a register as a string (‚Äúfp‚Äù for example
for the above ‚Äúrbp‚Äù)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bitsize</span></code> - Size in bits of a register (32, 64, etc).  Base 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">offset</span></code> -
The offset within the ‚Äúg‚Äù and ‚ÄúG‚Äù packet of the register data for
this register.  This is the byte offset once the data has been
transformed into binary, not the character offset into the g/G
packet.  Base 10.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encoding</span></code> -
The encoding type of the register which must be one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">uint</span></code> (unsigned integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sint</span></code> (signed integer)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ieee754</span></code> (IEEE 754 float)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector</span></code> (vector register)</p></li>
</ul>
</li>
<li><p>format -
The preferred format for display of this register. The value must be one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">binary</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decimal</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hex</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-sint8</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-uint8</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-sint16</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-uint16</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-sint32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-uint32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-float32</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vector-uint128</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">set</span></code>-
The register set name as a string that this register belongs to.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gcc</span></code> -
The GCC compiler registers number for this register (used for
EH frame and other compiler information that is encoded in the
executable files). The supplied number will be decoded like a
string passed to strtoul() with a base of zero, so the number
can be decimal, or hex if it is prefixed with ‚Äú0x‚Äù.</p>
<p><strong>Note:</strong> If the compiler doesn‚Äôt have a register number for this
register, this key/value pair should be omitted.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">dwarf</span></code> -
The DWARF register number for this register that is used for this
register in the debug information. The supplied number will be decoded
like a string passed to strtoul() with a base of zero, so the number
can be decimal, or hex if it is prefixed with ‚Äú0x‚Äù.</p>
<p><strong>Note:</strong> If the compiler doesn‚Äôt have a register number for this
register, this key/value pair should be omitted.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">generic</span></code> -
If the register is a generic register that most CPUs have, classify
it correctly so the debugger knows. Valid values are one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pc</span></code> (a program counter register. for example <code class="docutils literal notranslate"><span class="pre">name=eip;</span></code> (i386),
<code class="docutils literal notranslate"><span class="pre">name=rip;</span></code> (x86_64), <code class="docutils literal notranslate"><span class="pre">name=r15;</span></code> (32 bit arm) would
include a <code class="docutils literal notranslate"><span class="pre">generic=pc;</span></code> key value pair)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sp</span></code> (a stack pointer register. for example <code class="docutils literal notranslate"><span class="pre">name=esp;</span></code> (i386),
<code class="docutils literal notranslate"><span class="pre">name=rsp;</span></code> (x86_64), <code class="docutils literal notranslate"><span class="pre">name=r13;</span></code> (32 bit arm) would
include a <code class="docutils literal notranslate"><span class="pre">generic=sp;</span></code> key value pair)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fp</span></code> (a frame pointer register. for example <code class="docutils literal notranslate"><span class="pre">name=ebp;</span></code> (i386),
<code class="docutils literal notranslate"><span class="pre">name=rbp;</span></code> (x86_64), <code class="docutils literal notranslate"><span class="pre">name=r7;</span></code> (32 bit arm with macosx
ABI) would include a <code class="docutils literal notranslate"><span class="pre">generic=fp;</span></code> key value pair)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ra</span></code> (a return address register. for example <code class="docutils literal notranslate"><span class="pre">name=lr;</span></code> (32 bit ARM)
would include a <code class="docutils literal notranslate"><span class="pre">generic=ra;</span></code> key value pair)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flags</span></code> (a CPU flags register. for example <code class="docutils literal notranslate"><span class="pre">name=eflags;</span></code> (i386),
<code class="docutils literal notranslate"><span class="pre">name=rflags;</span></code> (x86_64), <code class="docutils literal notranslate"><span class="pre">name=cpsr;</span></code> (32 bit ARM)
would include a <code class="docutils literal notranslate"><span class="pre">generic=flags;</span></code> key value pair)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arg1</span></code> - <code class="docutils literal notranslate"><span class="pre">arg8</span></code> (specified for registers that contain function
arguments when the argument fits into a register)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">container-regs</span></code> -
The value for this key is a comma separated list of raw hex (optional
leading ‚Äú0x‚Äù) register numbers.</p>
<p>This specifies that this register is contained in other concrete
register values. For example ‚Äúeax‚Äù is in the lower 32 bits of the
‚Äúrax‚Äù register value for x86_64, so ‚Äúeax‚Äù could specify that it is
contained in ‚Äúrax‚Äù by specifying the register number for ‚Äúrax‚Äù (whose
register number is 0x00):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">container</span><span class="o">-</span><span class="n">regs</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span>
</pre></div>
</div>
<p>If a register is comprised of one or more registers, like ‚Äúd0‚Äù is ARM
which is a 64 bit register, it might be made up of ‚Äús0‚Äù and ‚Äús1‚Äù. If
the register number for ‚Äús0‚Äù is 0x20, and the register number of ‚Äús1‚Äù
is ‚Äú0x21‚Äù, the ‚Äúcontainer-regs‚Äù key/value pair would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">container</span><span class="o">-</span><span class="n">regs</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">;</span>
</pre></div>
</div>
<p>This is handy for defining what GDB used to call ‚Äúpseudo‚Äù registers.
These registers are never requested by LLDB via the register read
or write packets, the container registers will be requested on behalf
of this register.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">invalidate-regs</span></code> -
The value for this key is a comma separated list of raw hex (optional
leading ‚Äú0x‚Äù) register numbers.</p>
<p>This specifies which register values should be invalidated when this
register is modified. For example if modifying ‚Äúeax‚Äù would cause ‚Äúrax‚Äù,
‚Äúeax‚Äù, ‚Äúax‚Äù, ‚Äúah‚Äù, and ‚Äúal‚Äù to be modified where rax is 0x0, eax is 0x15,
ax is 0x25, ah is 0x35, and al is 0x39, the ‚Äúinvalidate-regs‚Äù key/value
pair would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">invalidate</span><span class="o">-</span><span class="n">regs</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">39</span><span class="p">;</span>
</pre></div>
</div>
<p>If there is a single register that gets invalidated, then omit the comma
and just list a single register:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">invalidate</span><span class="o">-</span><span class="n">regs</span><span class="p">:</span><span class="mi">0</span><span class="p">;</span>
</pre></div>
</div>
<p>This is handy when modifying a specific register can cause other
register values to change. For example, when debugging an ARM target,
modifying the CPSR register can cause the r8 - r14 and cpsr value to
change depending on if the mode has changed.</p>
</li>
</ul>
<p><strong>Priority To Implement:</strong> High. Any target that can self describe its registers,
should do so. This means if new registers are ever added to a remote target, they
will get picked up automatically, and allows registers to change
depending on the actual CPU type that is used.</p>
<p><strong>Note:</strong> <code class="docutils literal notranslate"><span class="pre">qRegisterInfo</span></code> is deprecated in favor of the standard gdb remote
serial protocol register description method, <code class="docutils literal notranslate"><span class="pre">qXfer:features:read:target.xml</span></code>.
If <code class="docutils literal notranslate"><span class="pre">qXfer:features:read:target.xml</span></code> is supported, <code class="docutils literal notranslate"><span class="pre">qRegisterInfo</span></code> does
not need to be implemented.  The target.xml format is used by most
gdb RSP stubs whereas <code class="docutils literal notranslate"><span class="pre">qRegisterInfo</span></code> was an lldb-only design.
<code class="docutils literal notranslate"><span class="pre">qRegisterInfo</span></code> requires one packet per register and can have undesirable
performance costs at the start of a debug session, whereas target.xml
may be able to describe all registers in a single packet.</p>
</section>
<section id="qshlibinfoaddr">
<h2>qShlibInfoAddr<a class="headerlink" href="#qshlibinfoaddr" title="Link to this heading">#</a></h2>
<p>Get an address where the dynamic linker stores information about
where shared libraries are loaded.</p>
<p>LLDB and GDB both support the <code class="docutils literal notranslate"><span class="pre">qShlibInfoAddr</span></code> packet which is a hint to each
debugger as to where to find the dynamic loader information. For darwin
binaries that run in user land this is the address of the <code class="docutils literal notranslate"><span class="pre">all_image_infos</span></code>
structure in the <code class="docutils literal notranslate"><span class="pre">/usr/lib/dyld</span></code> executable, or the result of a <code class="docutils literal notranslate"><span class="pre">TASK_DYLD_INFO</span></code>
call. The result is returned as big endian hex bytes that are the address
value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qShlibInfoAddr#00
read packet: $7fff5fc40040#00
</pre></div>
</div>
<p><strong>Priority To Implement:</strong> High</p>
<p>If you have a dynamic loader plug-in in LLDB for your target
triple (see the ‚ÄúqHostInfo‚Äù packet) that can use this information.
Many times address load randomization can make it hard to detect
where the dynamic loader binary and data structures are located and
some platforms know, or can find out where this information is.</p>
<p>Low if you have a debug target where all object and symbol files
contain static load addresses.</p>
</section>
<section id="qspeedtest">
<h2>qSpeedTest<a class="headerlink" href="#qspeedtest" title="Link to this heading">#</a></h2>
<p>Test the maximum speed at which packets can be sent and received.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">qSpeedTest</span><span class="p">:</span><span class="n">response_size</span><span class="p">:</span><span class="o">&lt;</span><span class="n">response</span> <span class="n">size</span><span class="o">&gt;</span><span class="p">;</span>
<span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">data</span><span class="p">:</span><span class="o">&lt;</span><span class="n">response</span> <span class="n">data</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&lt;response</span> <span class="pre">size&gt;</span></code> is a hex encoded unsigned number up to 64 bits in size.
The remote will respond with <code class="docutils literal notranslate"><span class="pre">data:</span></code> followed by a block of <code class="docutils literal notranslate"><span class="pre">a</span></code> characters
whose size should match <code class="docutils literal notranslate"><span class="pre">&lt;response</span> <span class="pre">size&gt;</span></code>, if the connection is stable.</p>
<p>If there is an error parsing the packet, the response is <code class="docutils literal notranslate"><span class="pre">E79</span></code>.</p>
<p>This packet is used by LLDB to discover how reliable the connection is by
varying the amount of data requested by <code class="docutils literal notranslate"><span class="pre">&lt;response</span> <span class="pre">size&gt;</span></code> and checking whether
the expected amount and values were received.</p>
<p><strong>Priority to Implemment:</strong> Not required for debugging on the same host, otherwise
low unless you know your connection quality is variable.</p>
</section>
<section id="qsymbol">
<h2>qSymbol<a class="headerlink" href="#qsymbol" title="Link to this heading">#</a></h2>
<p>Notify the remote that LLDB is ready to do symbol lookups on behalf of the
debug server. The response is the symbol name the debug server wants to know the
value of, or <code class="docutils literal notranslate"><span class="pre">OK</span></code> if the debug server does not need to know any more symbol values.</p>
<p>The exchange always begins with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">send</span> <span class="n">packet</span><span class="p">:</span> <span class="n">qSymbol</span><span class="p">::</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">::</span></code> are delimiters for fields that may be filled in future responses. These
delimiters must be included even in the first packet sent.</p>
<p>The debug server can reply one of two ways. If it doesn‚Äôt need any symbol values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">OK</span>
</pre></div>
</div>
<p>If it does need a symbol value, it includes the ASCII hex encoded name of the
symbol:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">qSymbol</span><span class="p">:</span><span class="mi">6578616</span><span class="n">D706C65</span>
</pre></div>
</div>
<p>This should be looked up by LLDB then sent back to the server. Include the name
again, with the vaue as a hex number:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">qSymbol</span><span class="p">:</span><span class="mi">6578616</span><span class="n">D706C65</span><span class="p">:</span><span class="n">CAFEF00D</span>
</pre></div>
</div>
<p>If LLDB cannot find the value, it should respond with only the name. Note that
the second <code class="docutils literal notranslate"><span class="pre">:</span></code> is not included here, whereas it is in the initial packet.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">read</span> <span class="n">packet</span><span class="p">:</span> <span class="n">qSymbol</span><span class="p">:</span><span class="mi">6578616</span><span class="n">D706C65</span>
</pre></div>
</div>
<p>If LLDB is asked for any symbols that it cannot find, it should send the
initial <code class="docutils literal notranslate"><span class="pre">qSymbol::</span></code> again at any point where new libraries are loaded. In case
the symbol can now be resolved.</p>
<p>If the debug server has requested all the symbols it wants, the final response
will be <code class="docutils literal notranslate"><span class="pre">OK</span></code> (whether they were all found or not).</p>
<p>If LLDB did find all the symbols and recieves an <code class="docutils literal notranslate"><span class="pre">OK</span></code> it does not need to send
<code class="docutils literal notranslate"><span class="pre">qSymbol::</span></code> again during the debug session.</p>
<p><strong>Priority To Implement:</strong> Low, this is rarely used.</p>
</section>
<section id="qthreadstopinfo-tid">
<h2>qThreadStopInfo&lt;tid&gt;<a class="headerlink" href="#qthreadstopinfo-tid" title="Link to this heading">#</a></h2>
<p>Get information about why a thread, whose ID is <code class="docutils literal notranslate"><span class="pre">&lt;tid&gt;</span></code>, is stopped.</p>
<p>LLDB tries to use the <code class="docutils literal notranslate"><span class="pre">qThreadStopInfo</span></code> packet which is formatted as
<code class="docutils literal notranslate"><span class="pre">qThreadStopInfo%x</span></code> where <code class="docutils literal notranslate"><span class="pre">%x</span></code> is the hex thread ID. This requests information
about why a thread is stopped. The response is the same as the stop reply
packets and tells us what happened to the other threads. The standard GDB
remote packets love to think that there is only <em>one</em> reason that <em>one</em> thread
stops at a time. This allows us to see why all threads stopped and allows us
to implement better multi-threaded debugging support.</p>
<p><strong>Priority To Implement:</strong> High</p>
<p>If you need to support multi-threaded or multi-core debugging.
Many times one thread will hit a breakpoint and while the debugger
is in the process of suspending the other threads, other threads
will also hit a breakpoint. This packet allows LLDB to know why all
threads (live system debug) / cores (JTAG) in your program have
stopped and allows LLDB to display and control your program
correctly.</p>
</section>
<section id="qwatchpointsupportinfo">
<h2>qWatchpointSupportInfo<a class="headerlink" href="#qwatchpointsupportinfo" title="Link to this heading">#</a></h2>
<p>Get the number of hardware watchpoints available on the remote target.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qWatchpointSupportInfo:#55
read packet: $num:4;#f9
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">num</span></code> is the number of hardware breakpoints, it will be <code class="docutils literal notranslate"><span class="pre">0</span></code> if none are
available.</p>
<p><strong>Priority to Implement:</strong> Low. If this packet is not supported, LLDB will assume
that hardware breakpoints are supported. If that is not the case, LLDB assumes
that the debug stub will respond with an error when asked to set a hardware
watchpoint.</p>
</section>
<section id="stop-reply-packet-extensions">
<h2>Stop reply packet extensions<a class="headerlink" href="#stop-reply-packet-extensions" title="Link to this heading">#</a></h2>
<p>This section describes some of the additional information you can
specify in stop reply packets that help LLDB to know more detailed
information about your threads.</p>
<p>Standard GDB remote stop reply packets are reply packets sent in
response to a packet  that made the program run. They come in the
following forms:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SAA</span></code> -
<code class="docutils literal notranslate"><span class="pre">S</span></code> means signal and <code class="docutils literal notranslate"><span class="pre">AA</span></code> is a hex signal number that describes why
the thread or stopped. It doesn‚Äôt specify which thread, so the <code class="docutils literal notranslate"><span class="pre">T</span></code>
packet is recommended to use instead of the <code class="docutils literal notranslate"><span class="pre">S</span></code> packet.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TAAkey1:value1;key2:value2;...</span></code> -
<code class="docutils literal notranslate"><span class="pre">T</span></code> means a thread stopped due to a unix signal where <code class="docutils literal notranslate"><span class="pre">AA</span></code> is a hex
signal number that describes why the program stopped. This is
followed by a series of key/value pairs:</p>
<ul>
<li><p>If key is a hex number, it is a register number and value is
the hex value of the register in debuggee endian byte order.</p></li>
<li><p>If key == ‚Äúthread‚Äù, then the value is the big endian hex
thread-id of the stopped thread.</p></li>
<li><p>If key == ‚Äúcore‚Äù, then value is a hex number of the core on
which the stop was detected.</p></li>
<li><p>If key == ‚Äúwatch‚Äù or key == ‚Äúrwatch‚Äù or key == ‚Äúawatch‚Äù, then
value is the data address in big endian hex</p></li>
<li><p>If key == ‚Äúlibrary‚Äù, then value is ignore and ‚ÄúqXfer:libraries:read‚Äù
packets should be used to detect any newly loaded shared libraries</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">WAA</span></code> - <code class="docutils literal notranslate"><span class="pre">W</span></code> means the process exited and <code class="docutils literal notranslate"><span class="pre">AA</span></code> is the exit status.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">XAA</span></code> - <code class="docutils literal notranslate"><span class="pre">X</span></code> means the process exited and <code class="docutils literal notranslate"><span class="pre">AA</span></code> is signal that caused the program
to exit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">O&lt;ascii-hex-string&gt;</span></code> - <code class="docutils literal notranslate"><span class="pre">O</span></code> means <code class="docutils literal notranslate"><span class="pre">STDOUT</span></code> has data that was written to its
console and is being delivered to the debugger. This packet happens asynchronously
and the debugger is expected to continue to wait for another stop reply
packet.</p></li>
</ul>
<section id="lldb-extensions">
<h3>Lldb Extensions<a class="headerlink" href="#lldb-extensions" title="Link to this heading">#</a></h3>
<p>We have extended the <code class="docutils literal notranslate"><span class="pre">T</span></code> packet to be able to also understand the
following keys and values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">metype</span></code> - <code class="docutils literal notranslate"><span class="pre">unsigned</span></code> -
mach exception type (the value of the <code class="docutils literal notranslate"><span class="pre">EXC_XXX</span></code> enumerations)
as an unsigned integer. For targets with mach
kernels only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mecount</span></code> - <code class="docutils literal notranslate"><span class="pre">unsigned</span></code> -
mach exception data count as an unsigned integer
For targets with mach kernels only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">medata</span></code> - <code class="docutils literal notranslate"><span class="pre">unsigned</span></code> -
There should be <code class="docutils literal notranslate"><span class="pre">mecount</span></code> of these and it is the data
that goes along with a mach exception (as an unsigned
integer). For targets with mach kernels only.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - <code class="docutils literal notranslate"><span class="pre">string</span></code> -
The name of the thread as a plain string. The string
must not contain an special packet characters or
contain a <code class="docutils literal notranslate"><span class="pre">:</span></code> or a <code class="docutils literal notranslate"><span class="pre">;</span></code>. Use <code class="docutils literal notranslate"><span class="pre">hexname</span></code> if the thread
name has special characters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hexname</span></code> - <code class="docutils literal notranslate"><span class="pre">ascii-hex</span></code> -  An ASCII hex string that contains the name of the thread</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">qaddr</span></code> - <code class="docutils literal notranslate"><span class="pre">hex</span></code> -
Big endian hex value that contains the <code class="docutils literal notranslate"><span class="pre">libdispatch</span></code>
queue address for the queue of the thread.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reason</span></code> - <code class="docutils literal notranslate"><span class="pre">enum</span></code> - The enumeration must be one of:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">trace</span></code> -
the program stopped after a single instruction
was executed on a core. Usually done when single
stepping past a breakpoint</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">breakpoint</span></code> - a breakpoint set using a <code class="docutils literal notranslate"><span class="pre">z</span></code> packet was hit.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trap</span></code> - stopped due to user interruption</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signal</span></code> -
stopped due to an actual unix signal, not
just the debugger using a unix signal to keep
the GDB remote client happy.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">watchpoint</span></code> - Can be used with of the <code class="docutils literal notranslate"><span class="pre">watch</span></code>/<code class="docutils literal notranslate"><span class="pre">rwatch</span></code>/<code class="docutils literal notranslate"><span class="pre">awatch</span></code> key value
pairs. Or can be used <em>instead</em> of those keys, with the specially formatted
<code class="docutils literal notranslate"><span class="pre">description</span></code> field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exception</span></code> - an exception stop reason. Use with
the <code class="docutils literal notranslate"><span class="pre">description</span></code> key/value pair to describe the
exceptional event the user should see as the stop
reason.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">description</span></code> -
An ASCII hex string that contains a more descriptive
reason that the thread stopped. This is only needed
if none of the key/value pairs are enough to
describe why something stopped.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">reason:watchpoint</span></code>, <code class="docutils literal notranslate"><span class="pre">description</span></code> is an ascii-hex
encoded string with between one and three base 10 numbers,
space separated.  The three numbers are:</p>
<ol class="arabic simple">
<li><p>Watchpoint address. This address should always be within
a memory region lldb has a watchpoint on.
On architectures where the actual reported hit address may
be outside the watchpoint that was triggered, the remote
stub should determine which watchpoint was triggered and
report an address from within its range.</p></li>
<li><p>Wwatchpoint hardware register index number.</p></li>
<li><p>Actual watchpoint trap address, which may be outside
the range of any watched region of memory. On MIPS, an addr
outside a watched range means lldb should disable the wp,
step, re-enable the wp and continue silently.</p></li>
</ol>
<p>On MIPS, the low 3 bits are masked so if a watchpoint is on
0x1004, a 2-byte write to 0x1000 will trigger the watchpoint
(a false positive hit), and lldb needs to disable the
watchpoint at 0x1004, inst-step, then re-enable the watchpoint
and not make this a user visible event. The description here
would be ‚Äú0x1004 0 0x1000‚Äù. lldb needs a known watchpoint address
in the first field, so it can disable it and step.</p>
<p>On AArch64 we have a related issue, where you watch 4 bytes at
0x1004, an instruction does an 8-byte write starting at
0x1000 (a true watchpoint hit) and the hardware may report the
trap address as 0x1000 - before the watched memory region -
with the write extending into the watched region.  This can
be reported as ‚Äú0x1004 0 0x1000‚Äù.  lldb will use 0x1004 to
identify which Watchpoint was triggered, and can report 0x1000
to the user.  The behavior of silently stepping over the
watchpoint, with an 3rd field addr outside the range, is
restricted to MIPS.</p>
<p>There may be false-positive watchpoint hits on AArch64 as well,
in the SVE Streaming Mode, but that is less common (see ESR
register flag ‚ÄúWPF‚Äù, ‚ÄúWatchpoint might be False-Positive‚Äù) and
not currently handled by lldb.</p>
</li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">threads</span></code> - <code class="docutils literal notranslate"><span class="pre">comma-sep-base16</span></code> -
A list of thread ids for all threads (including
the thread that we‚Äôre reporting as stopped) that
are live in the process right now.  lldb may
request that this be included in the T packet via
the QListThreadsInStopReply packet earlier in
the debug session.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">threads</span><span class="p">:</span><span class="mi">63387</span><span class="p">,</span><span class="mi">633</span><span class="n">b2</span><span class="p">,</span><span class="mi">63424</span><span class="p">,</span><span class="mi">63462</span><span class="p">,</span><span class="mi">63486</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">thread-pcs</span></code> - <code class="docutils literal notranslate"><span class="pre">comma-sep-base16</span></code> -
A list of pc values for all threads that currently
exist in the process, including the thread that
this <code class="docutils literal notranslate"><span class="pre">T</span></code> packet is reporting as stopped.
This key-value pair will only be emitted when the
<code class="docutils literal notranslate"><span class="pre">threads</span></code> key is already included in the <code class="docutils literal notranslate"><span class="pre">T</span></code> packet.
The pc values correspond to the threads reported
in the <code class="docutils literal notranslate"><span class="pre">threads</span></code> list.  The number of pcs in the
<code class="docutils literal notranslate"><span class="pre">thread-pcs</span></code> list will be the same as the number of
threads in the <code class="docutils literal notranslate"><span class="pre">threads</span></code> list.
lldb may request that this be included in the <code class="docutils literal notranslate"><span class="pre">T</span></code>
packet via the <code class="docutils literal notranslate"><span class="pre">QListThreadsInStopReply</span></code> packet
earlier in the debug session.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thread</span><span class="o">-</span><span class="n">pcs</span><span class="p">:</span><span class="n">dec14</span><span class="p">,</span><span class="mi">2</span><span class="n">cf872b0</span><span class="p">,</span><span class="mi">2</span><span class="n">cf8681c</span><span class="p">,</span><span class="mi">2</span><span class="n">d02d68c</span><span class="p">,</span><span class="mi">2</span><span class="n">cf716a8</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">addressing_bits</span></code> - <code class="docutils literal notranslate"><span class="pre">unsigned</span></code> (optional) -
Specifies how many bits in addresses are significant for addressing, base
10.  If bits 38..0 in a 64-bit pointer are significant for addressing, then the
value is 39. This is needed on e.g. AArch64 v8.3 ABIs that use pointer
authentication in the high bits. This value is normally sent in the <code class="docutils literal notranslate"><span class="pre">qHostInfo</span></code>
packet response, and if the value cannot change during the process lifetime,
it does not need to be duplicated here in the stop packet. For a firmware
environment with early start code that may be changing the page table setup,
a dynamically set value may be needed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">low_mem_addressing_bits</span></code> - <code class="docutils literal notranslate"><span class="pre">unsigned</span></code> (optional) -
Specifies how many bits in addresses in low memory are significant for
addressing, base 10.  AArch64 can have different page table setups for low
and high memory, and therefore a different number of bits used for addressing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">high_mem_addressing_bits</span></code> - <code class="docutils literal notranslate"><span class="pre">unsigned</span></code> (optional) -
Specifies how many bits in addresses in high memory are significant for
addressing, base 10.  AArch64 can have different page table setups for low and
high memory, and therefore a different number of bits used for addressing.</p></li>
</ul>
</section>
<section id="best-practices">
<h3>Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">#</a></h3>
<p>Since register values can be supplied with this packet, it is often useful
to return the PC, SP, FP, LR (if any), and FLAGS registers so that separate
packets don‚Äôt need to be sent to read each of these registers from each
thread.</p>
<p>If a thread is stopped for no reason (like just because another thread
stopped, or because when one core stops all cores should stop), use a
<code class="docutils literal notranslate"><span class="pre">T</span></code> packet with <code class="docutils literal notranslate"><span class="pre">00</span></code> as the signal number and fill in as many key values
and registers as possible.</p>
<p>LLDB likes to know why a thread stopped since many thread control
operations like stepping over a source line, actually are implemented
by running the process multiple times. If a breakpoint is hit while
trying to step over a source line and LLDB finds out that a breakpoint
is hit in the ‚Äúreason‚Äù, we will know to stop trying to do the step
over because something happened that should stop us from trying to
do the step. If we are at a breakpoint and we disable the breakpoint
at the current PC and do an instruction single step, knowing that
we stopped due to a ‚Äútrace‚Äù helps us know that we can continue
running versus stopping due to a ‚Äúbreakpoint‚Äù (if we have two
breakpoint instruction on consecutive instructions). So the more info
we can get about the reason a thread stops, the better job LLDB can
do when controlling your process. A typical GDB server behavior is
to send a SIGTRAP for breakpoints <em>and</em> also when instruction single
stepping, in this case the debugger doesn‚Äôt really know why we
stopped and it can make it hard for the debugger to control your
program correctly. What if a real SIGTRAP was delivered to a thread
while we were trying to single step? We wouldn‚Äôt know the difference
with a standard GDB remote server and we could do the wrong thing.</p>
<p><strong>Priority To Implement:</strong> High. Having the extra information in your stop reply
packets makes your debug session more reliable and informative.</p>
</section>
</section>
<section id="vattachname">
<h2>vAttachName<a class="headerlink" href="#vattachname" title="Link to this heading">#</a></h2>
<p>Same as <code class="docutils literal notranslate"><span class="pre">vAttach</span></code>, except instead of a <code class="docutils literal notranslate"><span class="pre">pid</span></code> you send a process name.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed for <code class="docutils literal notranslate"><span class="pre">process</span> <span class="pre">attach</span> <span class="pre">-n</span></code>. If the
packet isn‚Äôt supported then <code class="docutils literal notranslate"><span class="pre">process</span> <span class="pre">attach</span> <span class="pre">-n</span></code> will fail gracefully. So you need
only to support it if attaching to a process by name makes sense for your environment.</p>
</section>
<section id="vattachorwait">
<h2>vAttachOrWait<a class="headerlink" href="#vattachorwait" title="Link to this heading">#</a></h2>
<p>Same as <code class="docutils literal notranslate"><span class="pre">vAttachWait</span></code>, except that the stub will attach to a process
by name if it exists, and if it does not, it will wait for a process
of that name to appear and attach to it.</p>
<p><strong>Priority To Implement:</strong> Low</p>
<p>Only needed to implement <code class="docutils literal notranslate"><span class="pre">process</span> <span class="pre">attach</span> <span class="pre">-w</span> <span class="pre">-i</span> <span class="pre">false</span> <span class="pre">-n</span></code>.  If
you don‚Äôt implement it but do implement <code class="docutils literal notranslate"><span class="pre">-n</span></code> AND lldb can somehow get
a process list from your device, it will fall back on scanning the
process list, and sending <code class="docutils literal notranslate"><span class="pre">vAttach</span></code> or <code class="docutils literal notranslate"><span class="pre">vAttachWait</span></code> depending on
whether the requested process exists already.  This is racy,
however, so if you want to support this behavior it is better to
support this packet.</p>
</section>
<section id="vattachwait">
<h2>vAttachWait<a class="headerlink" href="#vattachwait" title="Link to this heading">#</a></h2>
<p>Same as <code class="docutils literal notranslate"><span class="pre">vAttachName</span></code>, except that the stub should wait for the next instance
of a process by that name to be launched and attach to that.</p>
<p><strong>Priority To Implement:</strong> Low. Only needed to support <code class="docutils literal notranslate"><span class="pre">process</span> <span class="pre">attach</span> <span class="pre">-w</span> <span class="pre">-n</span></code>
which will fail gracefully if the packet is not supported.</p>
</section>
<section id="vfile-packets">
<h2>vFile Packets<a class="headerlink" href="#vfile-packets" title="Link to this heading">#</a></h2>
<p>Though some of these may match the ones described in GDB‚Äôs protocol
documentation, we include our own expectations here in case of
mismatches or extensions.</p>
<section id="vfile-chmod-qplatform-chmod">
<h3>vFile:chmod / qPlatform_chmod<a class="headerlink" href="#vfile-chmod-qplatform-chmod" title="Link to this heading">#</a></h3>
<p>Change the permissions of a file on the connected remote machine.</p>
<p>Request: <code class="docutils literal notranslate"><span class="pre">qPlatform_chmod:&lt;hex-file-mode&gt;,&lt;ascii-hex-path&gt;</span></code></p>
<p>Reply:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F&lt;chmod-return-code&gt;</span></code>
(chmod called successfully and returned with the given return code)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Exx</span></code> (An error occurred)</p></li>
</ul>
</section>
<section id="vfile-close">
<h3>vFile:close<a class="headerlink" href="#vfile-close" title="Link to this heading">#</a></h3>
<p>Close a previously opened file descriptor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">close</span><span class="p">:</span><span class="mi">7</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">F0</span>
</pre></div>
</div>
<p>File descriptor is in base 16. <code class="docutils literal notranslate"><span class="pre">F-1,errno</span></code> with the errno if an error occurs,
errno is base 16.</p>
</section>
<section id="vfile-exists">
<h3>vFile:exists<a class="headerlink" href="#vfile-exists" title="Link to this heading">#</a></h3>
<p>Check whether the file at the given path exists.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">exists</span><span class="p">:</span><span class="mi">2</span><span class="n">f746d702f61</span>
<span class="n">send</span>         <span class="p">(</span><span class="n">exists</span><span class="p">):</span> <span class="n">F</span><span class="p">,</span><span class="mi">1</span>
<span class="n">send</span> <span class="p">(</span><span class="n">does</span> <span class="ow">not</span> <span class="n">exist</span><span class="p">):</span> <span class="n">F</span><span class="p">,</span><span class="mi">0</span>
</pre></div>
</div>
<p>Request packet contains the ASCII hex encoded filename.</p>
<p>The response is a return code where 1 means the file exists
and 0 means it does not.</p>
<p><strong>Priority To Implement:</strong> Low</p>
</section>
<section id="vfile-md5">
<h3>vFile:MD5<a class="headerlink" href="#vfile-md5" title="Link to this heading">#</a></h3>
<p>Generate an MD5 hash of the file at the given path.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">MD5</span><span class="p">:</span><span class="mi">2</span><span class="n">f746d702f61</span>
<span class="n">send</span> <span class="p">(</span><span class="n">success</span><span class="p">):</span> <span class="n">F</span><span class="p">,</span><span class="mi">00000000000000001111111111111111</span>
<span class="n">send</span> <span class="p">(</span><span class="n">failure</span><span class="p">):</span> <span class="n">F</span><span class="p">,</span><span class="n">x</span>
</pre></div>
</div>
<p>Request packet contains the ASCII hex encoded filename.</p>
<p>If the hash succeeded, the response is <code class="docutils literal notranslate"><span class="pre">F,</span></code> followed by the low 64
bits of the result, and finally the high 64 bits of the result. Both are in
hex format without a prefix.</p>
<p>The response is <code class="docutils literal notranslate"><span class="pre">F,</span></code>, followed by <code class="docutils literal notranslate"><span class="pre">x</span></code> if the file did not exist
or failed to hash.</p>
</section>
<section id="vfile-mode">
<h3>vFile:mode<a class="headerlink" href="#vfile-mode" title="Link to this heading">#</a></h3>
<p>Get the mode bits of a file on the target system, filename in ASCII hex.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">mode</span><span class="p">:</span><span class="mi">2</span><span class="n">f746d702f61</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">F1ed</span>
</pre></div>
</div>
<p>response is <code class="docutils literal notranslate"><span class="pre">F</span></code> followed by the mode bits in base 16, this <code class="docutils literal notranslate"><span class="pre">0x1ed</span></code> would
correspond to <code class="docutils literal notranslate"><span class="pre">0755</span></code> in octal.
<code class="docutils literal notranslate"><span class="pre">F-1,errno</span></code> with the errno if an error occurs, base 16.</p>
</section>
<section id="vfile-open">
<h3>vFile:open<a class="headerlink" href="#vfile-open" title="Link to this heading">#</a></h3>
<p>Open a file on the remote system and return the file descriptor of it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="nb">open</span><span class="p">:</span><span class="mi">2</span><span class="n">f746d702f61</span><span class="p">,</span><span class="mi">00000001</span><span class="p">,</span><span class="mi">00000180</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">F8</span>
</pre></div>
</div>
<p>request packet has the fields:</p>
<ol class="arabic simple">
<li><p>ASCII hex encoded filename</p></li>
<li><p>Flags passed to the open call, base 16.
Note that these are not the <code class="docutils literal notranslate"><span class="pre">oflags</span></code> that <code class="docutils literal notranslate"><span class="pre">open(2)</span></code> takes, but
are the constant values in <code class="docutils literal notranslate"><span class="pre">enum</span> <span class="pre">OpenOptions</span></code> from LLDB‚Äôs
<a class="reference external" href="https://github.com/llvm/llvm-project/blob/main/lldb/include/lldb/Host/File.h"><code class="docutils literal notranslate"><span class="pre">File.h</span></code></a>.</p></li>
<li><p>Mode bits, base 16</p></li>
</ol>
<p>response is <code class="docutils literal notranslate"><span class="pre">F</span></code> followed by the opened file descriptor in base 16.
<code class="docutils literal notranslate"><span class="pre">F-1,errno</span></code> with the errno if an error occurs, base 16.</p>
</section>
<section id="vfile-pread">
<h3>vFile:pread<a class="headerlink" href="#vfile-pread" title="Link to this heading">#</a></h3>
<p>Read data from an opened file descriptor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">pread</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span><span class="mi">1024</span><span class="p">,</span><span class="mi">0</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">F4</span><span class="p">;</span><span class="n">a</span><span class="s1">&#39;b</span><span class="se">\00</span>
</pre></div>
</div>
<p>Request packet has the fields:</p>
<ol class="arabic simple">
<li><p>File descriptor, base 16</p></li>
<li><p>Number of bytes to be read, base 16</p></li>
<li><p>Offset into file to start from, base 16</p></li>
</ol>
<p>Response is <code class="docutils literal notranslate"><span class="pre">F</span></code>, followed by the number of bytes read (base 16), a
semicolon, followed by the data in the binary-escaped-data encoding.</p>
</section>
<section id="vfile-pwrite">
<h3>vFile:pwrite<a class="headerlink" href="#vfile-pwrite" title="Link to this heading">#</a></h3>
<p>Write data to a previously opened file descriptor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">pwrite</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>\<span class="n">cf</span>\<span class="n">fa</span>\<span class="n">ed</span>\<span class="n">fe</span>\<span class="mi">0</span><span class="n">c</span>\<span class="mi">00</span>\<span class="mi">00</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">F1024</span>
</pre></div>
</div>
<p>Request packet has the fields:</p>
<ol class="arabic simple">
<li><p>File descriptor, base 16</p></li>
<li><p>Offset into file to start from, base 16</p></li>
<li><p>binary-escaped-data to be written</p></li>
</ol>
<p>Response is <code class="docutils literal notranslate"><span class="pre">F</span></code>, followed by the number of bytes written (base 16).</p>
</section>
<section id="vfile-size">
<h3>vFile:size<a class="headerlink" href="#vfile-size" title="Link to this heading">#</a></h3>
<p>Get the size of a file on the target system, filename in ASCII hex.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">size</span><span class="p">:</span><span class="mi">2</span><span class="n">f746d702f61</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">Fc008</span>
</pre></div>
</div>
<p>response is <code class="docutils literal notranslate"><span class="pre">F</span></code> followed by the file size in base 16.
<code class="docutils literal notranslate"><span class="pre">F-1,errno</span></code> with the errno if an error occurs, base 16.</p>
</section>
<section id="vfile-symlink">
<h3>vFile:symlink<a class="headerlink" href="#vfile-symlink" title="Link to this heading">#</a></h3>
<p>Create a symbolic link (symlink, soft-link) on the target system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">symlink</span><span class="p">:</span><span class="o">&lt;</span><span class="n">SRC</span><span class="o">-</span><span class="n">FILE</span><span class="o">&gt;</span><span class="p">,</span><span class="o">&lt;</span><span class="n">DST</span><span class="o">-</span><span class="n">NAME</span><span class="o">&gt;</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">F0</span><span class="p">,</span><span class="mi">0</span>
</pre></div>
</div>
<p>Argument file paths are in ascii-hex encoding.
Response is <code class="docutils literal notranslate"><span class="pre">F</span></code> plus the return value of <code class="docutils literal notranslate"><span class="pre">symlink()</span></code>, base 16 encoding,
optionally followed by the value of errno if it failed, also base 16.</p>
</section>
<section id="vfile-unlink">
<h3>vFile:unlink<a class="headerlink" href="#vfile-unlink" title="Link to this heading">#</a></h3>
<p>Remove a file on the target system.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">receive</span><span class="p">:</span> <span class="n">vFile</span><span class="p">:</span><span class="n">unlink</span><span class="p">:</span><span class="mi">2</span><span class="n">f746d702f61</span>
<span class="n">send</span><span class="p">:</span>    <span class="n">F0</span>
</pre></div>
</div>
<p>Argument is a file path in ascii-hex encoding.
Response is <code class="docutils literal notranslate"><span class="pre">F</span></code> plus the return value of <code class="docutils literal notranslate"><span class="pre">unlink()</span></code>, base 16 encoding.
Return value may optionally be followed by a comma and the base16
value of errno if unlink failed.</p>
</section>
</section>
<section id="x-binary-memory-read">
<h2>‚Äúx‚Äù - Binary memory read<a class="headerlink" href="#x-binary-memory-read" title="Link to this heading">#</a></h2>
<blockquote>
<div><p><strong>Warning:</strong> The format of this packet was decided before GDB 16
introduced its own format for <code class="docutils literal notranslate"><span class="pre">x</span></code>. Future versions of LLDB may not
support the format described here, and new code should produce and
expect the format used by GDB.</p>
</div></blockquote>
<p>Like the <code class="docutils literal notranslate"><span class="pre">m</span></code> (read) and <code class="docutils literal notranslate"><span class="pre">M</span></code> (write) packets, this is a partner to the
<code class="docutils literal notranslate"><span class="pre">X</span></code> (write binary data) packet, <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>It is called like</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xADDRESS</span><span class="p">,</span><span class="n">LENGTH</span>
</pre></div>
</div>
<p>where both <code class="docutils literal notranslate"><span class="pre">ADDRESS</span></code> and <code class="docutils literal notranslate"><span class="pre">LENGTH</span></code> are big-endian base 16 values.</p>
<p>To test if this packet is available, send a addr/len of 0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span><span class="p">,</span><span class="mi">0</span>
</pre></div>
</div>
<p>You will get an <code class="docutils literal notranslate"><span class="pre">OK</span></code> response if it is supported.</p>
<p>The reply will be the data requested in 8-bit binary data format.
The standard quoting is applied to the payload. Characters <code class="docutils literal notranslate"><span class="pre">}</span>&#160; <span class="pre">#</span>&#160; <span class="pre">$</span>&#160; <span class="pre">*</span></code>
will all be escaped with <code class="docutils literal notranslate"><span class="pre">}</span></code> (<code class="docutils literal notranslate"><span class="pre">0x7d</span></code>) character and then XOR‚Äôed with <code class="docutils literal notranslate"><span class="pre">0x20</span></code>.</p>
<p>A typical use to read 512 bytes at 0x1000 would look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x0x1000</span><span class="p">,</span><span class="mh">0x200</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">0x</span></code> prefixes are optional - like most of the gdb-remote packets,
omitting them will work fine; these numbers are always base 16.</p>
<p>The length of the payload is not provided.  A reliable, 8-bit clean,
transport layer is assumed.</p>
</section>
<section id="wasm-packets">
<h2>Wasm Packets<a class="headerlink" href="#wasm-packets" title="Link to this heading">#</a></h2>
<p>The packet below are supported by the
<a class="reference external" href="https://github.com/bytecodealliance/wasm-micro-runtime">WAMR</a> and
<a class="reference external" href="https://v8.dev">V8</a> Wasm runtimes.</p>
<section id="qwasmcallstack">
<h3>qWasmCallStack<a class="headerlink" href="#qwasmcallstack" title="Link to this heading">#</a></h3>
<p>Get the Wasm call stack for the given thread id. This returns a hex-encoded
list of PC values, one for each frame of the call stack. To match the Wasm
specification, the addresses are encoded in little endian byte order, even if
the endian of the Wasm runtime‚Äôs host is not little endian.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qWasmCallStack:202dbe040#08
read packet: $9c01000000000040e501000000000040fe01000000000040#
</pre></div>
</div>
<p><strong>Priority to Implement:</strong> Only required for Wasm support. Necessary to show
stack traces.</p>
</section>
<section id="qwasmglobal">
<h3>qWasmGlobal<a class="headerlink" href="#qwasmglobal" title="Link to this heading">#</a></h3>
<p>Get the value of a Wasm global variable for the given frame index at the given
variable index. The indexes are encoded as base 10. The result is a hex-encoded
address from where to read the value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qWasmGlobal:0;2#cb
read packet: $e0030100#b9
</pre></div>
</div>
<p><strong>Priority to Implement:</strong> Only required for Wasm support. Necessary to show
variables.</p>
</section>
<section id="qwasmlocal">
<h3>qWasmLocal<a class="headerlink" href="#qwasmlocal" title="Link to this heading">#</a></h3>
<p>Get the value of a Wasm function argument or local variable for the given frame
index at the given variable index. The indexes are encoded as base 10. The
result is a hex-encoded address from where to read the value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qWasmLocal:0;2#cb
read packet: $e0030100#b9
</pre></div>
</div>
<p><strong>Priority to Implement:</strong> Only required for Wasm support. Necessary to show
variables.</p>
</section>
<section id="qwasmstackvalue">
<h3>qWasmStackValue<a class="headerlink" href="#qwasmstackvalue" title="Link to this heading">#</a></h3>
<p>Get the value of a Wasm local variable from the Wasm operand stack, for the
given frame index at the given variable index. The indexes are encoded as base
10. The result is a hex-encoded address from where to read value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>send packet: $qWasmStackValue:0;2#cb
read packet: $e0030100#b9
</pre></div>
</div>
<p><strong>Priority to Implement:</strong> Only required for Wasm support. Necessary to show
variables.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="lldbplatformpackets.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">LLDB Platform Packets</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="extensions.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">DWARF Extensions</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2007-2025, The LLDB Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Aug 13, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">GDB Remote Protocol Extensions</a><ul>
<li><a class="reference internal" href="#m-size-permissions">_M&lt;size&gt;,&lt;permissions&gt;</a></li>
<li><a class="reference internal" href="#m-addr">_m&lt;addr&gt;</a></li>
<li><a class="reference internal" href="#a-launch-args-packet">‚ÄúA‚Äù - launch args packet</a></li>
<li><a class="reference internal" href="#d-detach-and-stay-stopped">‚ÄúD‚Äù - Detach and stay stopped</a></li>
<li><a class="reference internal" href="#jgetdyldprocessstate">jGetDyldProcessState</a></li>
<li><a class="reference internal" href="#jgetloadeddynamiclibrariesinfos">jGetLoadedDynamicLibrariesInfos</a></li>
<li><a class="reference internal" href="#jgetsharedcacheinfo">jGetSharedCacheInfo</a></li>
<li><a class="reference internal" href="#jmodulesinfo-file-triple">jModulesInfo:[{‚Äúfile‚Äù:‚Äù‚Ä¶‚Äù,triple:‚Äù‚Ä¶‚Äù}, ‚Ä¶]</a></li>
<li><a class="reference internal" href="#jlldbtracegetbinarydata">jLLDBTraceGetBinaryData</a><ul>
<li><a class="reference internal" href="#schema">Schema</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jlldbtracegetstate">jLLDBTraceGetState</a><ul>
<li><a class="reference internal" href="#input-schema">Input Schema</a></li>
<li><a class="reference internal" href="#output-schema">Output Schema</a></li>
<li><a class="reference internal" href="#intel-pt">Intel Pt</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jlldbtracestart">jLLDBTraceStart</a><ul>
<li><a class="reference internal" href="#process-tracing">Process Tracing</a></li>
<li><a class="reference internal" href="#thread-tracing">Thread Tracing</a></li>
<li><a class="reference internal" href="#id1">Input Schema</a></li>
<li><a class="reference internal" href="#id2">Intel-Pt</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jlldbtracestop">jLLDBTraceStop</a><ul>
<li><a class="reference internal" href="#process-trace-stopping">Process Trace Stopping</a></li>
<li><a class="reference internal" href="#thread-trace-stopping">Thread Trace Stopping</a></li>
<li><a class="reference internal" href="#id3">Input Schema</a></li>
<li><a class="reference internal" href="#id4">Intel Pt</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jlldbtracesupported">jLLDBTraceSupported</a><ul>
<li><a class="reference internal" href="#id5">Output Schema</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jthreadextendedinfo">jThreadExtendedInfo</a></li>
<li><a class="reference internal" href="#jthreadsinfo">jThreadsInfo</a></li>
<li><a class="reference internal" href="#qenvironment-name-value">QEnvironment:NAME=VALUE</a></li>
<li><a class="reference internal" href="#qenvironmenthexencoded-hex-encoding-name-value">QEnvironmentHexEncoded:HEX-ENCODING(NAME=VALUE)</a></li>
<li><a class="reference internal" href="#qenablecompression">QEnableCompression</a></li>
<li><a class="reference internal" href="#qenableerrorstrings">QEnableErrorStrings</a></li>
<li><a class="reference internal" href="#qlauncharch">QLaunchArch</a></li>
<li><a class="reference internal" href="#qlistthreadsinstopreply">QListThreadsInStopReply</a></li>
<li><a class="reference internal" href="#qrestoreregisterstate-save-id-qrestoreregisterstate-save-id-thread-xxxx">QRestoreRegisterState:&lt;save_id&gt; / QRestoreRegisterState:&lt;save_id&gt;;thread:XXXX;</a></li>
<li><a class="reference internal" href="#qsaveregisterstate-qsaveregisterstate-thread-xxxx">QSaveRegisterState / QSaveRegisterState;thread:XXXX;</a></li>
<li><a class="reference internal" href="#qsetdetachonerror">QSetDetachOnError</a></li>
<li><a class="reference internal" href="#qsetdisableaslr-bool">QSetDisableASLR:&lt;bool&gt;</a></li>
<li><a class="reference internal" href="#qsetstdin-ascii-hex-path-qsetstdout-ascii-hex-path-qsetstderr-ascii-hex-path">QSetSTDIN:&lt;ascii-hex-path&gt; / QSetSTDOUT:&lt;ascii-hex-path&gt; / QSetSTDERR:&lt;ascii-hex-path&gt;</a></li>
<li><a class="reference internal" href="#qsetworkingdir-ascii-hex-path">QSetWorkingDir:&lt;ascii-hex-path&gt;</a></li>
<li><a class="reference internal" href="#qstartnoackmode">QStartNoAckMode</a></li>
<li><a class="reference internal" href="#qsupported">QSupported</a></li>
<li><a class="reference internal" href="#qthreadsuffixsupported">QThreadSuffixSupported</a></li>
<li><a class="reference internal" href="#qattachorwaitsupported">qAttachOrWaitSupported</a></li>
<li><a class="reference internal" href="#qfileloadaddress-file-path">qFileLoadAddress:&lt;file_path&gt;</a></li>
<li><a class="reference internal" href="#qfprocessinfo-qsprocessinfo-platform-extension">qfProcessInfo / qsProcessInfo (Platform Extension)</a></li>
<li><a class="reference internal" href="#qgdbserverversion">qGDBServerVersion</a></li>
<li><a class="reference internal" href="#qgetworkingdir">qGetWorkingDir</a></li>
<li><a class="reference internal" href="#qhostinfo">qHostInfo</a></li>
<li><a class="reference internal" href="#qkillspawnedprocess-platform-extension">qKillSpawnedProcess (Platform Extension)</a></li>
<li><a class="reference internal" href="#qlaunchgdbserver-platform-extension">qLaunchGDBServer (Platform Extension)</a></li>
<li><a class="reference internal" href="#qlaunchsuccess">qLaunchSuccess</a></li>
<li><a class="reference internal" href="#qmemoryregioninfo-addr">qMemoryRegionInfo:&lt;addr&gt;</a></li>
<li><a class="reference internal" href="#qmoduleinfo-module-path-arch-triple">qModuleInfo:&lt;module_path&gt;;&lt;arch triple&gt;</a></li>
<li><a class="reference internal" href="#qpathcomplete-platform-extension">qPathComplete (Platform Extension)</a></li>
<li><a class="reference internal" href="#qplatform-mkdir">qPlatform_mkdir</a></li>
<li><a class="reference internal" href="#qplatform-shell">qPlatform_shell</a></li>
<li><a class="reference internal" href="#qprocessinfo">qProcessInfo</a></li>
<li><a class="reference internal" href="#qprocessinfopid-pid-platform-extension">qProcessInfoPID:PID (Platform Extension)</a></li>
<li><a class="reference internal" href="#qquerygdbserver">qQueryGDBServer</a></li>
<li><a class="reference internal" href="#qregisterinfo-hex-reg-id">qRegisterInfo&lt;hex-reg-id&gt;</a></li>
<li><a class="reference internal" href="#qshlibinfoaddr">qShlibInfoAddr</a></li>
<li><a class="reference internal" href="#qspeedtest">qSpeedTest</a></li>
<li><a class="reference internal" href="#qsymbol">qSymbol</a></li>
<li><a class="reference internal" href="#qthreadstopinfo-tid">qThreadStopInfo&lt;tid&gt;</a></li>
<li><a class="reference internal" href="#qwatchpointsupportinfo">qWatchpointSupportInfo</a></li>
<li><a class="reference internal" href="#stop-reply-packet-extensions">Stop reply packet extensions</a><ul>
<li><a class="reference internal" href="#lldb-extensions">Lldb Extensions</a></li>
<li><a class="reference internal" href="#best-practices">Best Practices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vattachname">vAttachName</a></li>
<li><a class="reference internal" href="#vattachorwait">vAttachOrWait</a></li>
<li><a class="reference internal" href="#vattachwait">vAttachWait</a></li>
<li><a class="reference internal" href="#vfile-packets">vFile Packets</a><ul>
<li><a class="reference internal" href="#vfile-chmod-qplatform-chmod">vFile:chmod / qPlatform_chmod</a></li>
<li><a class="reference internal" href="#vfile-close">vFile:close</a></li>
<li><a class="reference internal" href="#vfile-exists">vFile:exists</a></li>
<li><a class="reference internal" href="#vfile-md5">vFile:MD5</a></li>
<li><a class="reference internal" href="#vfile-mode">vFile:mode</a></li>
<li><a class="reference internal" href="#vfile-open">vFile:open</a></li>
<li><a class="reference internal" href="#vfile-pread">vFile:pread</a></li>
<li><a class="reference internal" href="#vfile-pwrite">vFile:pwrite</a></li>
<li><a class="reference internal" href="#vfile-size">vFile:size</a></li>
<li><a class="reference internal" href="#vfile-symlink">vFile:symlink</a></li>
<li><a class="reference internal" href="#vfile-unlink">vFile:unlink</a></li>
</ul>
</li>
<li><a class="reference internal" href="#x-binary-memory-read">‚Äúx‚Äù - Binary memory read</a></li>
<li><a class="reference internal" href="#wasm-packets">Wasm Packets</a><ul>
<li><a class="reference internal" href="#qwasmcallstack">qWasmCallStack</a></li>
<li><a class="reference internal" href="#qwasmglobal">qWasmGlobal</a></li>
<li><a class="reference internal" href="#qwasmlocal">qWasmLocal</a></li>
<li><a class="reference internal" href="#qwasmstackvalue">qWasmStackValue</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=7f41d439"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>